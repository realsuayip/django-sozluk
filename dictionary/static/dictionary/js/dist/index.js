!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},i={},o=t.parcelRequire53a9;null==o&&((o=function(e){if(e in n)return n[e].exports;if(e in i){var t=i[e];delete i[e];var o={id:e,exports:{}};return n[e]=o,t.call(o.exports,o,o.exports),o.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){i[e]=t},t.parcelRequire53a9=o),o.register("iS9jW",(function(e,t){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return r(this,n)}}function r(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}var h=function(){function e(){u(this,e)}return p(e,[{key:"on",value:function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}},{key:"emit",value:function(e){this._callbacks=this._callbacks||{};var t=this._callbacks[e];if(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var r,a=l(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.apply(this,i)}}catch(e){a.e(e)}finally{a.f()}}return this}},{key:"off",value:function(e,t){if(!this._callbacks||0===arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(var i=0;i<n.length;i++){var o=n[i];if(o===t){n.splice(i,1);break}}return this}}]),e}(),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,i){var o,s,l;if(u(this,n),(o=t.call(this)).element=e,o.version=n.version,o.defaultOptions.previewTemplate=o.defaultOptions.previewTemplate.replace(/\n*/g,""),o.clickableElements=[],o.listeners=[],o.files=[],"string"==typeof o.element&&(o.element=document.querySelector(o.element)),!o.element||null==o.element.nodeType)throw new Error("Invalid dropzone element.");if(o.element.dropzone)throw new Error("Dropzone already attached.");n.instances.push(a(o)),o.element.dropzone=a(o);var c=null!=(l=n.optionsForElement(o.element))?l:{};if(o.options=n.extend({},o.defaultOptions,c,null!=i?i:{}),o.options.forceFallback||!n.isBrowserSupported())return r(o,o.options.fallback.call(a(o)));if(null==o.options.url&&(o.options.url=o.element.getAttribute("action")),!o.options.url)throw new Error("No URL provided.");if(o.options.acceptedFiles&&o.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(o.options.uploadMultiple&&o.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");return o.options.acceptedMimeTypes&&(o.options.acceptedFiles=o.options.acceptedMimeTypes,delete o.options.acceptedMimeTypes),null!=o.options.renameFilename&&(o.options.renameFile=function(e){return o.options.renameFilename.call(a(o),e.name,e)}),"string"==typeof o.options.method&&(o.options.method=o.options.method.toUpperCase()),(s=o.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),!1!==o.options.previewsContainer&&(o.options.previewsContainer?o.previewsContainer=n.getElement(o.options.previewsContainer,"previewsContainer"):o.previewsContainer=o.element),o.options.clickable&&(!0===o.options.clickable?o.clickableElements=[o.element]:o.clickableElements=n.getElements(o.options.clickable,"clickable")),o.init(),o}return p(n,null,[{key:"initClass",value:function(){this.prototype.Emitter=h,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,timeout:3e4,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2e6,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictUploadCanceled:"Upload canceled.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init:function(){},params:function(e,t,n){if(n)return{dzuuid:n.file.upload.uuid,dzchunkindex:n.index,dztotalfilesize:n.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:n.file.upload.totalChunkCount,dzchunkbyteoffset:n.index*this.options.chunkSize}},accept:function(e,t){return t()},chunksUploaded:function(e,t){t()},fallback:function(){var e;this.element.className="".concat(this.element.className," dz-browser-not-supported");var t,i=l(this.element.getElementsByTagName("div"));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(/(^| )dz-message($| )/.test(o.className)){e=o,o.className="dz-message";break}}}catch(e){i.e(e)}finally{i.f()}e||(e=n.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(e));var r=e.getElementsByTagName("span")[0];return r&&(null!=r.textContent?r.textContent=this.options.dictFallbackMessage:null!=r.innerText&&(r.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(e,t,n,i){var o={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},r=e.width/e.height;null==t&&null==n?(t=o.srcWidth,n=o.srcHeight):null==t?t=n*r:null==n&&(n=t/r);var a=(t=Math.min(t,o.srcWidth))/(n=Math.min(n,o.srcHeight));if(o.srcWidth>t||o.srcHeight>n)if("crop"===i)r>a?(o.srcHeight=e.height,o.srcWidth=o.srcHeight*a):(o.srcWidth=e.width,o.srcHeight=o.srcWidth/a);else{if("contain"!==i)throw new Error("Unknown resizeMethod '".concat(i,"'"));r>a?n=t/r:t=n*r}return o.srcX=(e.width-o.srcWidth)/2,o.srcY=(e.height-o.srcHeight)/2,o.trgWidth=t,o.trgHeight=n,o},transformFile:function(e,t){return(this.options.resizeWidth||this.options.resizeHeight)&&e.type.match(/image.*/)?this.resizeImage(e,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,t):t(e)},previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <title>Check</title>\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <title>Error</title>\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>',drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:function(e){},dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:function(e){},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var t=this;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){e.previewElement=n.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement);var i,o=l(e.previewElement.querySelectorAll("[data-dz-name]"));try{for(o.s();!(i=o.n()).done;){var r=i.value;r.textContent=e.name}}catch(e){o.e(e)}finally{o.f()}var a,s=l(e.previewElement.querySelectorAll("[data-dz-size]"));try{for(s.s();!(a=s.n()).done;)(r=a.value).innerHTML=this.filesize(e.size)}catch(e){s.e(e)}finally{s.f()}this.options.addRemoveLinks&&(e._removeLink=n.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'.concat(this.options.dictRemoveFile,"</a>")),e.previewElement.appendChild(e._removeLink));var c,u=function(i){return i.preventDefault(),i.stopPropagation(),e.status===n.UPLOADING?n.confirm(t.options.dictCancelUploadConfirmation,(function(){return t.removeFile(e)})):t.options.dictRemoveFileConfirmation?n.confirm(t.options.dictRemoveFileConfirmation,(function(){return t.removeFile(e)})):t.removeFile(e)},d=l(e.previewElement.querySelectorAll("[data-dz-remove]"));try{for(d.s();!(c=d.n()).done;){c.value.addEventListener("click",u)}}catch(e){d.e(e)}finally{d.f()}}},removedfile:function(e){return null!=e.previewElement&&null!=e.previewElement.parentNode&&e.previewElement.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){if(e.previewElement){e.previewElement.classList.remove("dz-file-preview");var n,i=l(e.previewElement.querySelectorAll("[data-dz-thumbnail]"));try{for(i.s();!(n=i.n()).done;){var o=n.value;o.alt=e.name,o.src=t}}catch(e){i.e(e)}finally{i.f()}return setTimeout((function(){return e.previewElement.classList.add("dz-image-preview")}),1)}},error:function(e,t){if(e.previewElement){e.previewElement.classList.add("dz-error"),"string"!=typeof t&&t.error&&(t=t.error);var n,i=l(e.previewElement.querySelectorAll("[data-dz-errormessage]"));try{for(i.s();!(n=i.n()).done;){n.value.textContent=t}}catch(e){i.e(e)}finally{i.f()}}},errormultiple:function(){},processing:function(e){if(e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink))return e._removeLink.innerHTML=this.options.dictCancelUpload},processingmultiple:function(){},uploadprogress:function(e,t,n){if(e.previewElement){var i,o=l(e.previewElement.querySelectorAll("[data-dz-uploadprogress]"));try{for(o.s();!(i=o.n()).done;){var r=i.value;"PROGRESS"===r.nodeName?r.value=t:r.style.width="".concat(t,"%")}}catch(e){o.e(e)}finally{o.f()}}},totaluploadprogress:function(){},sending:function(){},sendingmultiple:function(){},success:function(e){if(e.previewElement)return e.previewElement.classList.add("dz-success")},successmultiple:function(){},canceled:function(e){return this.emit("error",e,this.options.dictUploadCanceled)},canceledmultiple:function(){},complete:function(e){if(e._removeLink&&(e._removeLink.innerHTML=this.options.dictRemoveFile),e.previewElement)return e.previewElement.classList.add("dz-complete")},completemultiple:function(){},maxfilesexceeded:function(){},maxfilesreached:function(){},queuecomplete:function(){},addedfiles:function(){}},this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}},{key:"extend",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var o=0,r=n;o<r.length;o++){var a=r[o];for(var s in a){var l=a[s];e[s]=l}}return e}}]),p(n,[{key:"getAcceptedFiles",value:function(){return this.files.filter((function(e){return e.accepted})).map((function(e){return e}))}},{key:"getRejectedFiles",value:function(){return this.files.filter((function(e){return!e.accepted})).map((function(e){return e}))}},{key:"getFilesWithStatus",value:function(e){return this.files.filter((function(t){return t.status===e})).map((function(e){return e}))}},{key:"getQueuedFiles",value:function(){return this.getFilesWithStatus(n.QUEUED)}},{key:"getUploadingFiles",value:function(){return this.getFilesWithStatus(n.UPLOADING)}},{key:"getAddedFiles",value:function(){return this.getFilesWithStatus(n.ADDED)}},{key:"getActiveFiles",value:function(){return this.files.filter((function(e){return e.status===n.UPLOADING||e.status===n.QUEUED})).map((function(e){return e}))}},{key:"init",value:function(){var e=this;if("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(n.createElement('<div class="dz-default dz-message"><button class="dz-button" type="button">'.concat(this.options.dictDefaultMessage,"</button></div>"))),this.clickableElements.length){!function t(){return e.hiddenFileInput&&e.hiddenFileInput.parentNode.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null===e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!==e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),null!==e.options.capture&&e.hiddenFileInput.setAttribute("capture",e.options.capture),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",n.getElement(e.options.hiddenInputContainer,"hiddenInputContainer").appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",(function(){var n=e.hiddenFileInput.files;if(n.length){var i,o=l(n);try{for(o.s();!(i=o.n()).done;){var r=i.value;e.addFile(r)}}catch(e){o.e(e)}finally{o.f()}}return e.emit("addedfiles",n),t()}))}()}this.URL=null!==window.URL?window.URL:window.webkitURL;var t,i=l(this.events);try{for(i.s();!(t=i.n()).done;){var o=t.value;this.on(o,this.options[o])}}catch(e){i.e(e)}finally{i.f()}this.on("uploadprogress",(function(){return e.updateTotalUploadProgress()})),this.on("removedfile",(function(){return e.updateTotalUploadProgress()})),this.on("canceled",(function(t){return e.emit("complete",t)})),this.on("complete",(function(t){if(0===e.getAddedFiles().length&&0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length)return setTimeout((function(){return e.emit("queuecomplete")}),0)}));var r=function(e){if(function(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1}(e))return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:function(t){return e.emit("dragstart",t)},dragenter:function(t){return r(t),e.emit("dragenter",t)},dragover:function(t){var n;try{n=t.dataTransfer.effectAllowed}catch(e){}return t.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",r(t),e.emit("dragover",t)},dragleave:function(t){return e.emit("dragleave",t)},drop:function(t){return r(t),e.drop(t)},dragend:function(t){return e.emit("dragend",t)}}}],this.clickableElements.forEach((function(t){return e.listeners.push({element:t,events:{click:function(i){return(t!==e.element||i.target===e.element||n.elementInside(i.target,e.element.querySelector(".dz-message")))&&e.hiddenFileInput.click(),!0}}})})),this.enable(),this.options.init.call(this)}},{key:"destroy",value:function(){return this.disable(),this.removeAllFiles(!0),(null!=this.hiddenFileInput?this.hiddenFileInput.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,n.instances.splice(n.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function(){var e,t=0,n=0;if(this.getActiveFiles().length){var i,o=l(this.getActiveFiles());try{for(o.s();!(i=o.n()).done;){var r=i.value;t+=r.upload.bytesSent,n+=r.upload.total}}catch(e){o.e(e)}finally{o.f()}e=100*t/n}else e=100;return this.emit("totaluploadprogress",e,n,t)}},{key:"_getParamName",value:function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):"".concat(this.options.paramName).concat(this.options.uploadMultiple?"[".concat(e,"]"):"")}},{key:"_renameFile",value:function(e){return"function"!=typeof this.options.renameFile?e.name:this.options.renameFile(e)}},{key:"getFallbackForm",value:function(){var e,t;if(e=this.getExistingFallback())return e;var i='<div class="dz-fallback">';this.options.dictFallbackText&&(i+="<p>".concat(this.options.dictFallbackText,"</p>")),i+='<input type="file" name="'.concat(this._getParamName(0),'" ').concat(this.options.uploadMultiple?'multiple="multiple"':void 0,' /><input type="submit" value="Upload!"></div>');var o=n.createElement(i);return"FORM"!==this.element.tagName?(t=n.createElement('<form action="'.concat(this.options.url,'" enctype="multipart/form-data" method="').concat(this.options.method,'"></form>'))).appendChild(o):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=t?t:o}},{key:"getExistingFallback",value:function(){for(var e=function(e){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(/(^| )fallback($| )/.test(i.className))return i}}catch(e){n.e(e)}finally{n.f()}},t=0,n=["div","form"];t<n.length;t++){var i,o=n[t];if(i=e(this.element.getElementsByTagName(o)))return i}}},{key:"setupEventListeners",value:function(){return this.listeners.map((function(e){return function(){var t=[];for(var n in e.events){var i=e.events[n];t.push(e.element.addEventListener(n,i,!1))}return t}()}))}},{key:"removeEventListeners",value:function(){return this.listeners.map((function(e){return function(){var t=[];for(var n in e.events){var i=e.events[n];t.push(e.element.removeEventListener(n,i,!1))}return t}()}))}},{key:"disable",value:function(){var e=this;return this.clickableElements.forEach((function(e){return e.classList.remove("dz-clickable")})),this.removeEventListeners(),this.disabled=!0,this.files.map((function(t){return e.cancelUpload(t)}))}},{key:"enable",value:function(){return delete this.disabled,this.clickableElements.forEach((function(e){return e.classList.add("dz-clickable")})),this.setupEventListeners()}},{key:"filesize",value:function(e){var t=0,n="b";if(e>0){for(var i=["tb","gb","mb","kb","b"],o=0;o<i.length;o++){var r=i[o];if(e>=Math.pow(this.options.filesizeBase,4-o)/10){t=e/Math.pow(this.options.filesizeBase,4-o),n=r;break}}t=Math.round(10*t)/10}return"<strong>".concat(t,"</strong> ").concat(this.options.dictFileSizeUnits[n])}},{key:"_updateMaxFilesReachedClass",value:function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}},{key:"drop",value:function(e){if(e.dataTransfer){this.emit("drop",e);for(var t=[],n=0;n<e.dataTransfer.files.length;n++)t[n]=e.dataTransfer.files[n];if(t.length){var i=e.dataTransfer.items;i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)}this.emit("addedfiles",t)}}},{key:"paste",value:function(e){if(null!=(t=null!=e?e.clipboardData:void 0,n=function(e){return e.items},null!=t?n(t):void 0)){var t,n;this.emit("paste",e);var i=e.clipboardData.items;return i.length?this._addFilesFromItems(i):void 0}}},{key:"handleFiles",value:function(e){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.addFile(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"_addFilesFromItems",value:function(e){var t=this;return function(){var n,i=[],o=l(e);try{for(o.s();!(n=o.n()).done;){var r,a=n.value;null!=a.webkitGetAsEntry&&(r=a.webkitGetAsEntry())?r.isFile?i.push(t.addFile(a.getAsFile())):r.isDirectory?i.push(t._addFilesFromDirectory(r,r.name)):i.push(void 0):null!=a.getAsFile&&(null==a.kind||"file"===a.kind)?i.push(t.addFile(a.getAsFile())):i.push(void 0)}}catch(e){o.e(e)}finally{o.f()}return i}()}},{key:"_addFilesFromDirectory",value:function(e,t){var n=this,i=e.createReader(),o=function(e){return t=console,n="log",i=function(t){return t.log(e)},null!=t&&"function"==typeof t[n]?i(t,n):void 0;var t,n,i};return function e(){return i.readEntries((function(i){if(i.length>0){var o,r=l(i);try{for(r.s();!(o=r.n()).done;){var a=o.value;a.isFile?a.file((function(e){if(!n.options.ignoreHiddenFiles||"."!==e.name.substring(0,1))return e.fullPath="".concat(t,"/").concat(e.name),n.addFile(e)})):a.isDirectory&&n._addFilesFromDirectory(a,"".concat(t,"/").concat(a.name))}}catch(e){r.e(e)}finally{r.f()}e()}return null}),o)}()}},{key:"accept",value:function(e,t){this.options.maxFilesize&&e.size>1048576*this.options.maxFilesize?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):n.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)}},{key:"addFile",value:function(e){var t=this;e.upload={uuid:n.uuidv4(),progress:0,total:e.size,bytesSent:0,filename:this._renameFile(e)},this.files.push(e),e.status=n.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,(function(n){n?(e.accepted=!1,t._errorProcessing([e],n)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}))}},{key:"enqueueFiles",value:function(e){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.enqueueFile(i)}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"enqueueFile",value:function(e){var t=this;if(e.status!==n.ADDED||!0!==e.accepted)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(e.status=n.QUEUED,this.options.autoProcessQueue)return setTimeout((function(){return t.processQueue()}),0)}},{key:"_enqueueThumbnail",value:function(e){var t=this;if(this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1048576*this.options.maxThumbnailFilesize)return this._thumbnailQueue.push(e),setTimeout((function(){return t._processThumbnailQueue()}),0)}},{key:"_processThumbnailQueue",value:function(){var e=this;if(!this._processingThumbnail&&0!==this._thumbnailQueue.length){this._processingThumbnail=!0;var t=this._thumbnailQueue.shift();return this.createThumbnail(t,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,(function(n){return e.emit("thumbnail",t,n),e._processingThumbnail=!1,e._processThumbnailQueue()}))}}},{key:"removeFile",value:function(e){if(e.status===n.UPLOADING&&this.cancelUpload(e),this.files=m(this.files,e),this.emit("removedfile",e),0===this.files.length)return this.emit("reset")}},{key:"removeAllFiles",value:function(e){null==e&&(e=!1);var t,i=l(this.files.slice());try{for(i.s();!(t=i.n()).done;){var o=t.value;(o.status!==n.UPLOADING||e)&&this.removeFile(o)}}catch(e){i.e(e)}finally{i.f()}return null}},{key:"resizeImage",value:function(e,t,i,o,r){var a=this;return this.createThumbnail(e,t,i,o,!0,(function(t,i){if(null==i)return r(e);var o=a.options.resizeMimeType;null==o&&(o=e.type);var s=i.toDataURL(o,a.options.resizeQuality);return"image/jpeg"!==o&&"image/jpg"!==o||(s=y.restore(e.dataURL,s)),r(n.dataURItoBlob(s))}))}},{key:"createThumbnail",value:function(e,t,n,i,o,r){var a=this,s=new FileReader;s.onload=function(){e.dataURL=s.result,"image/svg+xml"!==e.type?a.createThumbnailFromUrl(e,t,n,i,o,r):null!=r&&r(s.result)},s.readAsDataURL(e)}},{key:"displayExistingFile",value:function(e,t,n,i){var o=this,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this.emit("addedfile",e),this.emit("complete",e),r){var a=function(t){o.emit("thumbnail",e,t),n&&n()};e.dataURL=t,this.createThumbnailFromUrl(e,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.resizeMethod,this.options.fixOrientation,a,i)}else this.emit("thumbnail",e,t),n&&n()}},{key:"createThumbnailFromUrl",value:function(e,t,n,i,o,r,a){var s=this,l=document.createElement("img");return a&&(l.crossOrigin=a),o="from-image"!=getComputedStyle(document.body).imageOrientation&&o,l.onload=function(){var a=function(e){return e(1)};return"undefined"!=typeof EXIF&&null!==EXIF&&o&&(a=function(e){return EXIF.getData(l,(function(){return e(EXIF.getTag(this,"Orientation"))}))}),a((function(o){e.width=l.width,e.height=l.height;var a=s.options.resize.call(s,e,t,n,i),c=document.createElement("canvas"),u=c.getContext("2d");switch(c.width=a.trgWidth,c.height=a.trgHeight,o>4&&(c.width=a.trgHeight,c.height=a.trgWidth),o){case 2:u.translate(c.width,0),u.scale(-1,1);break;case 3:u.translate(c.width,c.height),u.rotate(Math.PI);break;case 4:u.translate(0,c.height),u.scale(1,-1);break;case 5:u.rotate(.5*Math.PI),u.scale(1,-1);break;case 6:u.rotate(.5*Math.PI),u.translate(0,-c.width);break;case 7:u.rotate(.5*Math.PI),u.translate(c.height,-c.width),u.scale(-1,1);break;case 8:u.rotate(-.5*Math.PI),u.translate(-c.height,0)}v(u,l,null!=a.srcX?a.srcX:0,null!=a.srcY?a.srcY:0,a.srcWidth,a.srcHeight,null!=a.trgX?a.trgX:0,null!=a.trgY?a.trgY:0,a.trgWidth,a.trgHeight);var d=c.toDataURL("image/png");if(null!=r)return r(d,c)}))},null!=r&&(l.onerror=r),l.src=e.dataURL}},{key:"processQueue",value:function(){var e=this.options.parallelUploads,t=this.getUploadingFiles().length,n=t;if(!(t>=e)){var i=this.getQueuedFiles();if(i.length>0){if(this.options.uploadMultiple)return this.processFiles(i.slice(0,e-t));for(;n<e;){if(!i.length)return;this.processFile(i.shift()),n++}}}}},{key:"processFile",value:function(e){return this.processFiles([e])}},{key:"processFiles",value:function(e){var t,i=l(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.processing=!0,o.status=n.UPLOADING,this.emit("processing",o)}}catch(e){i.e(e)}finally{i.f()}return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)}},{key:"_getFilesWithXhr",value:function(e){return this.files.filter((function(t){return t.xhr===e})).map((function(e){return e}))}},{key:"cancelUpload",value:function(e){if(e.status===n.UPLOADING){var t,i=this._getFilesWithXhr(e.xhr),o=l(i);try{for(o.s();!(t=o.n()).done;){t.value.status=n.CANCELED}}catch(e){o.e(e)}finally{o.f()}void 0!==e.xhr&&e.xhr.abort();var r,a=l(i);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.emit("canceled",s)}}catch(e){a.e(e)}finally{a.f()}this.options.uploadMultiple&&this.emit("canceledmultiple",i)}else e.status!==n.ADDED&&e.status!==n.QUEUED||(e.status=n.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));if(this.options.autoProcessQueue)return this.processQueue()}},{key:"resolveOption",value:function(e){if("function"==typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.apply(this,n)}return e}},{key:"uploadFile",value:function(e){return this.uploadFiles([e])}},{key:"uploadFiles",value:function(e){var t=this;this._transformFiles(e,(function(i){if(t.options.chunking){var o=i[0];e[0].upload.chunked=t.options.chunking&&(t.options.forceChunking||o.size>t.options.chunkSize),e[0].upload.totalChunkCount=Math.ceil(o.size/t.options.chunkSize)}if(e[0].upload.chunked){var r=e[0],a=i[0];r.upload.chunks=[];var s=function(){for(var i=0;void 0!==r.upload.chunks[i];)i++;if(!(i>=r.upload.totalChunkCount)){0;var o=i*t.options.chunkSize,s=Math.min(o+t.options.chunkSize,a.size),l={name:t._getParamName(0),data:a.webkitSlice?a.webkitSlice(o,s):a.slice(o,s),filename:r.upload.filename,chunkIndex:i};r.upload.chunks[i]={file:r,index:i,dataBlock:l,status:n.UPLOADING,progress:0,retries:0},t._uploadData(e,[l])}};if(r.upload.finishedChunkUpload=function(i){var o=!0;i.status=n.SUCCESS,i.dataBlock=null,i.xhr=null;for(var a=0;a<r.upload.totalChunkCount;a++){if(void 0===r.upload.chunks[a])return s();r.upload.chunks[a].status!==n.SUCCESS&&(o=!1)}o&&t.options.chunksUploaded(r,(function(){t._finished(e,"",null)}))},t.options.parallelChunkUploads)for(var l=0;l<r.upload.totalChunkCount;l++)s();else s()}else{for(var c=[],u=0;u<e.length;u++)c[u]={name:t._getParamName(u),data:i[u],filename:e[u].upload.filename};t._uploadData(e,c)}}))}},{key:"_getChunk",value:function(e,t){for(var n=0;n<e.upload.totalChunkCount;n++)if(void 0!==e.upload.chunks[n]&&e.upload.chunks[n].xhr===t)return e.upload.chunks[n]}},{key:"_uploadData",value:function(e,t){var i,o=this,r=new XMLHttpRequest,a=l(e);try{for(a.s();!(i=a.n()).done;){i.value.xhr=r}}catch(e){a.e(e)}finally{a.f()}e[0].upload.chunked&&(e[0].upload.chunks[t[0].chunkIndex].xhr=r);var s=this.resolveOption(this.options.method,e),c=this.resolveOption(this.options.url,e);r.open(s,c,!0),r.timeout=this.resolveOption(this.options.timeout,e),r.withCredentials=!!this.options.withCredentials,r.onload=function(t){o._finishedUploading(e,r,t)},r.ontimeout=function(){o._handleUploadError(e,r,"Request timedout after ".concat(o.options.timeout/1e3," seconds"))},r.onerror=function(){o._handleUploadError(e,r)},(null!=r.upload?r.upload:r).onprogress=function(t){return o._updateFilesUploadProgress(e,r,t)};var u={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};for(var d in this.options.headers&&n.extend(u,this.options.headers),u){var p=u[d];p&&r.setRequestHeader(d,p)}var h=new FormData;if(this.options.params){var f=this.options.params;for(var m in"function"==typeof f&&(f=f.call(this,e,r,e[0].upload.chunked?this._getChunk(e[0],r):null)),f){var g=f[m];if(Array.isArray(g))for(var v=0;v<g.length;v++)h.append(m,g[v]);else h.append(m,g)}}var y,b=l(e);try{for(b.s();!(y=b.n()).done;){var w=y.value;this.emit("sending",w,r,h)}}catch(e){b.e(e)}finally{b.f()}this.options.uploadMultiple&&this.emit("sendingmultiple",e,r,h),this._addFormElementData(h);for(var k=0;k<t.length;k++){var x=t[k];h.append(x.name,x.data,x.filename)}this.submitRequest(r,h,e)}},{key:"_transformFiles",value:function(e,t){for(var n=this,i=[],o=0,r=function(r){n.options.transformFile.call(n,e[r],(function(n){i[r]=n,++o===e.length&&t(i)}))},a=0;a<e.length;a++)r(a)}},{key:"_addFormElementData",value:function(e){if("FORM"===this.element.tagName){var t,n=l(this.element.querySelectorAll("input, textarea, select, button"));try{for(n.s();!(t=n.n()).done;){var i=t.value,o=i.getAttribute("name"),r=i.getAttribute("type");if(r&&(r=r.toLowerCase()),null!=o)if("SELECT"===i.tagName&&i.hasAttribute("multiple")){var a,s=l(i.options);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.selected&&e.append(o,c.value)}}catch(e){s.e(e)}finally{s.f()}}else(!r||"checkbox"!==r&&"radio"!==r||i.checked)&&e.append(o,i.value)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"_updateFilesUploadProgress",value:function(e,t,n){var i;if(void 0!==n){if(i=100*n.loaded/n.total,e[0].upload.chunked){var o=e[0],r=this._getChunk(o,t);r.progress=i,r.total=n.total,r.bytesSent=n.loaded;o.upload.progress=0,o.upload.total=0,o.upload.bytesSent=0;for(var a=0;a<o.upload.totalChunkCount;a++)void 0!==o.upload.chunks[a]&&void 0!==o.upload.chunks[a].progress&&(o.upload.progress+=o.upload.chunks[a].progress,o.upload.total+=o.upload.chunks[a].total,o.upload.bytesSent+=o.upload.chunks[a].bytesSent);o.upload.progress=o.upload.progress/o.upload.totalChunkCount}else{var s,c=l(e);try{for(c.s();!(s=c.n()).done;){var u=s.value;u.upload.progress=i,u.upload.total=n.total,u.upload.bytesSent=n.loaded}}catch(e){c.e(e)}finally{c.f()}}var d,p=l(e);try{for(p.s();!(d=p.n()).done;){var h=d.value;this.emit("uploadprogress",h,h.upload.progress,h.upload.bytesSent)}}catch(e){p.e(e)}finally{p.f()}}else{var f=!0;i=100;var m,g=l(e);try{for(g.s();!(m=g.n()).done;){var v=m.value;100===v.upload.progress&&v.upload.bytesSent===v.upload.total||(f=!1),v.upload.progress=i,v.upload.bytesSent=v.upload.total}}catch(e){g.e(e)}finally{g.f()}if(f)return;var y,b=l(e);try{for(b.s();!(y=b.n()).done;){var w=y.value;this.emit("uploadprogress",w,i,w.upload.bytesSent)}}catch(e){b.e(e)}finally{b.f()}}}},{key:"_finishedUploading",value:function(e,t,i){var o;if(e[0].status!==n.CANCELED&&4===t.readyState){if("arraybuffer"!==t.responseType&&"blob"!==t.responseType&&(o=t.responseText,t.getResponseHeader("content-type")&&~t.getResponseHeader("content-type").indexOf("application/json")))try{o=JSON.parse(o)}catch(e){i=e,o="Invalid JSON response from server."}this._updateFilesUploadProgress(e),200<=t.status&&t.status<300?e[0].upload.chunked?e[0].upload.finishedChunkUpload(this._getChunk(e[0],t)):this._finished(e,o,i):this._handleUploadError(e,t,o)}}},{key:"_handleUploadError",value:function(e,t,i){if(e[0].status!==n.CANCELED){if(e[0].upload.chunked&&this.options.retryChunks){var o=this._getChunk(e[0],t);if(o.retries++<this.options.retryChunksLimit)return void this._uploadData(e,[o.dataBlock]);console.warn("Retried this chunk too often. Giving up.")}this._errorProcessing(e,i||this.options.dictResponseError.replace("{{statusCode}}",t.status),t)}}},{key:"submitRequest",value:function(e,t,n){e.send(t)}},{key:"_finished",value:function(e,t,i){var o,r=l(e);try{for(r.s();!(o=r.n()).done;){var a=o.value;a.status=n.SUCCESS,this.emit("success",a,t,i),this.emit("complete",a)}}catch(e){r.e(e)}finally{r.f()}if(this.options.uploadMultiple&&(this.emit("successmultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()}},{key:"_errorProcessing",value:function(e,t,i){var o,r=l(e);try{for(r.s();!(o=r.n()).done;){var a=o.value;a.status=n.ERROR,this.emit("error",a,t,i),this.emit("complete",a)}}catch(e){r.e(e)}finally{r.f()}if(this.options.uploadMultiple&&(this.emit("errormultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()}}],[{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}}]),n}(h);f.initClass(),f.version="5.7.2",f.options={},f.optionsForElement=function(e){return e.getAttribute("id")?f.options[g(e.getAttribute("id"))]:void 0},f.instances=[],f.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},f.autoDiscover=!0,f.discover=function(){var e;if(document.querySelectorAll)e=document.querySelectorAll(".dropzone");else{e=[];var t=function(t){return function(){var n,i=[],o=l(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;/(^| )dropzone($| )/.test(r.className)?i.push(e.push(r)):i.push(void 0)}}catch(e){o.e(e)}finally{o.f()}return i}()};t(document.getElementsByTagName("div")),t(document.getElementsByTagName("form"))}return function(){var t,n=[],i=l(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;!1!==f.optionsForElement(o)?n.push(new f(o)):n.push(void 0)}}catch(e){i.e(e)}finally{i.f()}return n}()},f.blacklistedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i],f.isBrowserSupported=function(){var e=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a")){var t,n=l(f.blacklistedBrowsers);try{for(n.s();!(t=n.n()).done;){t.value.test(navigator.userAgent)&&(e=!1)}}catch(e){n.e(e)}finally{n.f()}}else e=!1;else e=!1;return e},f.dataURItoBlob=function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),o=new Uint8Array(i),r=0,a=t.length,s=0<=a;s?r<=a:r>=a;s?r++:r--)o[r]=t.charCodeAt(r);return new Blob([i],{type:n})};var m=function(e,t){return e.filter((function(e){return e!==t})).map((function(e){return e}))},g=function(e){return e.replace(/[\-_](\w)/g,(function(e){return e.charAt(1).toUpperCase()}))};f.createElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]},f.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},f.getElement=function(e,t){var n;if("string"==typeof e?n=document.querySelector(e):null!=e.nodeType&&(n=e),null==n)throw new Error("Invalid `".concat(t,"` option provided. Please provide a CSS selector or a plain HTML element."));return n},f.getElements=function(e,t){var n,i;if(e instanceof Array){i=[];try{var o,r=l(e);try{for(r.s();!(o=r.n()).done;)n=o.value,i.push(this.getElement(n,t))}catch(e){r.e(e)}finally{r.f()}}catch(e){i=null}}else if("string"==typeof e){i=[];var a,s=l(document.querySelectorAll(e));try{for(s.s();!(a=s.n()).done;)n=a.value,i.push(n)}catch(e){s.e(e)}finally{s.f()}}else null!=e.nodeType&&(i=[e]);if(null==i||!i.length)throw new Error("Invalid `".concat(t,"` option provided. Please provide a CSS selector, a plain HTML element or a list of those."));return i},f.confirm=function(e,t,n){return window.confirm(e)?t():null!=n?n():void 0},f.isValidFile=function(e,t){if(!t)return!0;t=t.split(",");var n,i=e.type,o=i.replace(/\/.*$/,""),r=l(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if("."===(a=a.trim()).charAt(0)){if(-1!==e.name.toLowerCase().indexOf(a.toLowerCase(),e.name.length-a.length))return!0}else if(/\/\*$/.test(a)){if(o===a.replace(/\/.*$/,""))return!0}else if(i===a)return!0}}catch(e){r.e(e)}finally{r.f()}return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(e){return this.each((function(){return new f(this,e)}))}),null!==e?e.exports=f:window.Dropzone=f,f.ADDED="added",f.QUEUED="queued",f.ACCEPTED=f.QUEUED,f.UPLOADING="uploading",f.PROCESSING=f.UPLOADING,f.CANCELED="canceled",f.ERROR="error",f.SUCCESS="success";var v=function(e,t,n,i,o,r,a,s,l,c){var u=function(e){e.naturalWidth;var t=e.naturalHeight,n=document.createElement("canvas");n.width=1,n.height=t;var i=n.getContext("2d");i.drawImage(e,0,0);for(var o=i.getImageData(1,0,1,t).data,r=0,a=t,s=t;s>r;)0===o[4*(s-1)+3]?a=s:r=s,s=a+r>>1;var l=s/t;return 0===l?1:l}(t);return e.drawImage(t,n,i,o,r,a,s,l,c/u)},y=function(){function e(){u(this,e)}return p(e,null,[{key:"initClass",value:function(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function(e){for(var t="",n=void 0,i=void 0,o="",r=void 0,a=void 0,s=void 0,l="",c=0;r=(n=e[c++])>>2,a=(3&n)<<4|(i=e[c++])>>4,s=(15&i)<<2|(o=e[c++])>>6,l=63&o,isNaN(i)?s=l=64:isNaN(o)&&(l=64),t=t+this.KEY_STR.charAt(r)+this.KEY_STR.charAt(a)+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(l),n=i=o="",r=a=s=l="",c<e.length;);return t}},{key:"restore",value:function(e,t){if(!e.match("data:image/jpeg;base64,"))return t;var n=this.decode64(e.replace("data:image/jpeg;base64,","")),i=this.slice2Segments(n),o=this.exifManipulation(t,i);return"data:image/jpeg;base64,".concat(this.encode64(o))}},{key:"exifManipulation",value:function(e,t){var n=this.getExifArray(t),i=this.insertExif(e,n);return new Uint8Array(i)}},{key:"getExifArray",value:function(e){for(var t=void 0,n=0;n<e.length;){if(255===(t=e[n])[0]&225===t[1])return t;n++}return[]}},{key:"insertExif",value:function(e,t){var n=e.replace("data:image/jpeg;base64,",""),i=this.decode64(n),o=i.indexOf(255,3),r=i.slice(0,o),a=i.slice(o),s=r;return s=(s=s.concat(t)).concat(a)}},{key:"slice2Segments",value:function(e){for(var t=0,n=[];;){if(255===e[t]&218===e[t+1])break;if(255===e[t]&216===e[t+1])t+=2;else{var i=t+(256*e[t+2]+e[t+3])+2,o=e.slice(t,i);n.push(o),t=i}if(t>e.length)break}return n}},{key:"decode64",value:function(e){var t=void 0,n=void 0,i="",o=void 0,r=void 0,a="",s=0,l=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&console.warn("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");t=this.KEY_STR.indexOf(e.charAt(s++))<<2|(o=this.KEY_STR.indexOf(e.charAt(s++)))>>4,n=(15&o)<<4|(r=this.KEY_STR.indexOf(e.charAt(s++)))>>2,i=(3&r)<<6|(a=this.KEY_STR.indexOf(e.charAt(s++))),l.push(t),64!==r&&l.push(n),64!==a&&l.push(i),t=n=i="",o=r=a="",s<e.length;);return l}}]),e}();y.initClass();f._autoDiscoverFunction=function(){if(f.autoDiscover)return f.discover()},function(e,t){var n=!1,i=!0,o=e.document,r=o.documentElement,a=o.addEventListener?"addEventListener":"attachEvent",s=o.addEventListener?"removeEventListener":"detachEvent",l=o.addEventListener?"":"on",c=function i(r){if("readystatechange"!==r.type||"complete"===o.readyState)return("load"===r.type?e:o)[s](l+r.type,i,!1),!n&&(n=!0)?t.call(e,r.type||r):void 0};if("complete"!==o.readyState){if(o.createEventObject&&r.doScroll){try{i=!e.frameElement}catch(e){}i&&function e(){try{r.doScroll("left")}catch(t){return void setTimeout(e,50)}return c("poll")}()}o[a](l+"DOMContentLoaded",c,!1),o[a](l+"readystatechange",c,!1),e[a](l+"load",c,!1)}}(window,f._autoDiscoverFunction)}));var r={};function a(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left,x:t.left,y:t.top}}function s(e){if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function l(e){var t=s(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function c(e){return e instanceof s(e).Element||e instanceof Element}function u(e){return e instanceof s(e).HTMLElement||e instanceof HTMLElement}function d(e){return e?(e.nodeName||"").toLowerCase():null}function p(e){return((c(e)?e.ownerDocument:e.document)||window.document).documentElement}function h(e){return a(p(e)).left+l(e).scrollLeft}function f(e){return s(e).getComputedStyle(e)}function m(e){var t=f(e),n=t.overflow,i=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+i)}function g(e,t,n){void 0===n&&(n=!1);var i,o,r=p(t),c=a(e),f=u(t),g={scrollLeft:0,scrollTop:0},v={x:0,y:0};return(f||!f&&!n)&&(("body"!==d(t)||m(r))&&(g=(i=t)!==s(i)&&u(i)?{scrollLeft:(o=i).scrollLeft,scrollTop:o.scrollTop}:l(i)),u(t)?((v=a(t)).x+=t.clientLeft,v.y+=t.clientTop):r&&(v.x=h(r))),{x:c.left+g.scrollLeft-v.x,y:c.top+g.scrollTop-v.y,width:c.width,height:c.height}}function v(e){return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}}function y(e){return"html"===d(e)?e:e.assignedSlot||e.parentNode||e.host||p(e)}function b(e){return["html","body","#document"].indexOf(d(e))>=0?e.ownerDocument.body:u(e)&&m(e)?e:b(y(e))}function w(e,t){void 0===t&&(t=[]);var n=b(e),i="body"===d(n),o=s(n),r=i?[o].concat(o.visualViewport||[],m(n)?n:[]):n,a=t.concat(r);return i?a:a.concat(w(y(r)))}function k(e){return["table","td","th"].indexOf(d(e))>=0}function x(e){if(!u(e)||"fixed"===f(e).position)return null;var t=e.offsetParent;if(t){var n=p(t);if("body"===d(t)&&"static"===f(t).position&&"static"!==f(n).position)return n}return t}function E(e){for(var t=s(e),n=x(e);n&&k(n)&&"static"===f(n).position;)n=x(n);return n&&"body"===d(n)&&"static"===f(n).position?t:n||function(e){for(var t=y(e);u(t)&&["html","body"].indexOf(d(t))<0;){var n=f(t);if("none"!==n.transform||"none"!==n.perspective||n.willChange&&"auto"!==n.willChange)return t;t=t.parentNode}return null}(e)||t}r=function(){"use strict";function e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}var t={read:function(e){return e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function n(i,o){function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({},o,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),n=i.write(n,t);var a="";for(var s in r)r[s]&&(a+="; "+s,!0!==r[s]&&(a+="="+r[s].split(";")[0]));return document.cookie=t+"="+n+a}}function a(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],o={},r=0;r<n.length;r++){var a=n[r].split("="),s=a.slice(1).join("=");'"'===s[0]&&(s=s.slice(1,-1));try{var l=t.read(a[0]);if(o[l]=i.read(s,l),e===l)break}catch(e){}}return e?o[e]:o}}return Object.create({set:r,get:a,remove:function(t,n){r(t,"",e({},n,{expires:-1}))},withAttributes:function(t){return n(this.converter,e({},this.attributes,t))},withConverter:function(t){return n(e({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(o)},converter:{value:Object.freeze(i)}})}return n(t,{path:"/"})}();var L="top",A="bottom",S="right",C="left",F="auto",_=[L,A,S,C],$="start",T="end",M="viewport",z="popper",O=_.reduce((function(e,t){return e.concat([t+"-"+$,t+"-"+T])}),[]),D=[].concat(_,[F]).reduce((function(e,t){return e.concat([t,t+"-"+$,t+"-"+T])}),[]),I=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function R(e){var t=new Map,n=new Set,i=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&o(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),i}function U(e){var t=R(e);return I.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}function j(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign(Object.assign(Object.assign({},n),t),{},{options:Object.assign(Object.assign({},n.options),t.options),data:Object.assign(Object.assign({},n.data),t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}var N={placement:"bottom",modifiers:[],strategy:"absolute"};function q(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function P(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,o=t.defaultOptions,r=void 0===o?N:o;return function(e,t,n){void 0===n&&(n=r);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign(Object.assign({},N),r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],u=!1,d={state:s,setOptions:function(n){p(),s.options=Object.assign(Object.assign(Object.assign({},r),s.options),n),s.scrollParents={reference:c(e)?w(e):e.contextElement?w(e.contextElement):[],popper:w(t)};var o=U(j([].concat(i,s.options.modifiers)));return s.orderedModifiers=o.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var r=o({state:s,name:t,instance:d,options:i}),a=function(){};l.push(r||a)}})),d.update()},forceUpdate:function(){if(!u){var e=s.elements,t=e.reference,n=e.popper;if(q(t,n)){s.rects={reference:g(t,E(n),"fixed"===s.options.strategy),popper:v(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<s.orderedModifiers.length;i++)if(!0!==s.reset){var o=s.orderedModifiers[i],r=o.fn,a=o.options,l=void 0===a?{}:a,c=o.name;"function"==typeof r&&(s=r({state:s,options:l,name:c,instance:d})||s)}else s.reset=!1,i=-1}}},update:(o=function(){return new Promise((function(e){d.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){p(),u=!0}};if(!q(e,t))return d;function p(){l.forEach((function(e){return e()})),l=[]}return d.setOptions(n).then((function(e){!u&&n.onFirstUpdate&&n.onFirstUpdate(e)})),d}}var H={passive:!0};function B(e){return e.split("-")[0]}function W(e){return e.split("-")[1]}function Q(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Y(e){var t,n=e.reference,i=e.element,o=e.placement,r=o?B(o):null,a=o?W(o):null,s=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(r){case L:t={x:s,y:n.y-i.height};break;case A:t={x:s,y:n.y+n.height};break;case S:t={x:n.x+n.width,y:l};break;case C:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var c=r?Q(r):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case $:t[c]=Math.floor(t[c])-Math.floor(n[u]/2-i[u]/2);break;case T:t[c]=Math.floor(t[c])+Math.ceil(n[u]/2-i[u]/2)}}return t}var K={top:"auto",right:"auto",bottom:"auto",left:"auto"};function X(e){var t,n=e.popper,i=e.popperRect,o=e.placement,r=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=function(e){var t=e.x,n=e.y,i=window.devicePixelRatio||1;return{x:Math.round(t*i)/i||0,y:Math.round(n*i)/i||0}}(r),d=u.x,h=u.y,f=r.hasOwnProperty("x"),m=r.hasOwnProperty("y"),g=C,v=L,y=window;if(c){var b=E(n);b===s(n)&&(b=p(n)),o===L&&(v=A,h-=b.clientHeight-i.height,h*=l?1:-1),o===C&&(g=S,d-=b.clientWidth-i.width,d*=l?1:-1)}var w,k=Object.assign({position:a},c&&K);return l?Object.assign(Object.assign({},k),{},((w={})[v]=m?"0":"",w[g]=f?"0":"",w.transform=(y.devicePixelRatio||1)<2?"translate("+d+"px, "+h+"px)":"translate3d("+d+"px, "+h+"px, 0)",w)):Object.assign(Object.assign({},k),{},((t={})[v]=m?h+"px":"",t[g]=f?d+"px":"",t.transform="",t))}var G=[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,o=i.scroll,r=void 0===o||o,a=i.resize,l=void 0===a||a,c=s(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&u.forEach((function(e){e.addEventListener("scroll",n.update,H)})),l&&c.addEventListener("resize",n.update,H),function(){r&&u.forEach((function(e){e.removeEventListener("scroll",n.update,H)})),l&&c.removeEventListener("resize",n.update,H)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Y({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,o=void 0===i||i,r=n.adaptive,a=void 0===r||r,s={placement:B(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign(Object.assign({},t.styles.popper),X(Object.assign(Object.assign({},s),{},{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign(Object.assign({},t.styles.arrow),X(Object.assign(Object.assign({},s),{},{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1})))),t.attributes.popper=Object.assign(Object.assign({},t.attributes.popper),{},{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},o=t.elements[e];u(o)&&d(o)&&(Object.assign(o.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],o=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});u(i)&&d(i)&&(Object.assign(i.style,r),Object.keys(o).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]}],V={left:"right",right:"left",bottom:"top",top:"bottom"};function Z(e){return e.replace(/left|right|bottom|top/g,(function(e){return V[e]}))}var J={start:"end",end:"start"};function ee(e){return e.replace(/start|end/g,(function(e){return J[e]}))}function te(e){var t=s(e),n=p(e),i=t.visualViewport,o=n.clientWidth,r=n.clientHeight,a=0,l=0;return i&&(o=i.width,r=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=i.offsetLeft,l=i.offsetTop)),{width:o,height:r,x:a+h(e),y:l}}function ne(e){var t=p(e),n=l(e),i=e.ownerDocument.body,o=Math.max(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=Math.max(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-n.scrollLeft+h(e),s=-n.scrollTop;return"rtl"===f(i||t).direction&&(a+=Math.max(t.clientWidth,i?i.clientWidth:0)-o),{width:o,height:r,x:a,y:s}}function ie(e,t){var n,i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if((n=i)instanceof s(n).ShadowRoot||n instanceof ShadowRoot){var o=t;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function oe(e){return Object.assign(Object.assign({},e),{},{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function re(e,t){return t===M?oe(te(e)):u(t)?function(e){var t=a(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):oe(ne(p(e)))}function ae(e,t,n){var i="clippingParents"===t?function(e){var t=w(y(e)),n=["absolute","fixed"].indexOf(f(e).position)>=0&&u(e)?E(e):e;return c(n)?t.filter((function(e){return c(e)&&ie(e,n)&&"body"!==d(e)})):[]}(e):[].concat(t),o=[].concat(i,[n]),r=o[0],a=o.reduce((function(t,n){var i=re(e,n);return t.top=Math.max(i.top,t.top),t.right=Math.min(i.right,t.right),t.bottom=Math.min(i.bottom,t.bottom),t.left=Math.max(i.left,t.left),t}),re(e,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function se(e){return Object.assign(Object.assign({},{top:0,right:0,bottom:0,left:0}),e)}function le(e,t){void 0===t&&(t={});var n,i=t,o=i.placement,r=void 0===o?e.placement:o,s=i.boundary,l=void 0===s?"clippingParents":s,u=i.rootBoundary,d=void 0===u?M:u,h=i.elementContext,f=void 0===h?z:h,m=i.altBoundary,g=void 0!==m&&m,v=i.padding,y=void 0===v?0:v,b=se("number"!=typeof y?y:(n=y,_.reduce((function(e,t){return e[t]=n,e}),{}))),w=f===z?"reference":z,k=e.elements.reference,x=e.rects.popper,E=e.elements[g?w:f],C=ae(c(E)?E:E.contextElement||p(e.elements.popper),l,d),F=a(k),$=Y({reference:F,element:x,strategy:"absolute",placement:r}),T=oe(Object.assign(Object.assign({},x),$)),O=f===z?T:F,D={top:C.top-O.top+b.top,bottom:O.bottom-C.bottom+b.bottom,left:C.left-O.left+b.left,right:O.right-C.right+b.right},I=e.modifiersData.offset;if(f===z&&I){var R=I[r];Object.keys(D).forEach((function(e){var t=[S,A].indexOf(e)>=0?1:-1,n=[L,A].indexOf(e)>=0?"y":"x";D[e]+=R[n]*t}))}return D}function ce(e,t){void 0===t&&(t={});var n=t,i=n.placement,o=n.boundary,r=n.rootBoundary,a=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?D:l,u=W(i),d=u?s?O:O.filter((function(e){return W(e)===u})):_,p=d.filter((function(e){return c.indexOf(e)>=0}));0===p.length&&(p=d);var h=p.reduce((function(t,n){return t[n]=le(e,{placement:n,boundary:o,rootBoundary:r,padding:a})[B(n)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}var ue={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var o=n.mainAxis,r=void 0===o||o,a=n.altAxis,s=void 0===a||a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,f=void 0===h||h,m=n.allowedAutoPlacements,g=t.options.placement,v=B(g),y=l||(v===g||!f?[Z(g)]:function(e){if(B(e)===F)return[];var t=Z(e);return[ee(e),t,ee(t)]}(g)),b=[g].concat(y).reduce((function(e,n){return e.concat(B(n)===F?ce(t,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),w=t.rects.reference,k=t.rects.popper,x=new Map,E=!0,_=b[0],T=0;T<b.length;T++){var M=b[T],z=B(M),O=W(M)===$,D=[L,A].indexOf(z)>=0,I=D?"width":"height",R=le(t,{placement:M,boundary:u,rootBoundary:d,altBoundary:p,padding:c}),U=D?O?S:C:O?A:L;w[I]>k[I]&&(U=Z(U));var j=Z(U),N=[];if(r&&N.push(R[z]<=0),s&&N.push(R[U]<=0,R[j]<=0),N.every((function(e){return e}))){_=M,E=!1;break}x.set(M,N)}if(E)for(var q=function(e){var t=b.find((function(t){var n=x.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return _=t,"break"},P=f?3:1;P>0;P--){if("break"===q(P))break}t.placement!==_&&(t.modifiersData[i]._skip=!0,t.placement=_,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function de(e,t,n){return Math.max(e,Math.min(t,n))}var pe={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,o=n.mainAxis,r=void 0===o||o,a=n.altAxis,s=void 0!==a&&a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,p=n.tether,h=void 0===p||p,f=n.tetherOffset,m=void 0===f?0:f,g=le(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),y=B(t.placement),b=W(t.placement),w=!b,k=Q(y),x="x"===k?"y":"x",F=t.modifiersData.popperOffsets,_=t.rects.reference,T=t.rects.popper,M="function"==typeof m?m(Object.assign(Object.assign({},t.rects),{},{placement:t.placement})):m,z={x:0,y:0};if(F){if(r){var O="y"===k?L:C,D="y"===k?A:S,I="y"===k?"height":"width",R=F[k],U=F[k]+g[O],j=F[k]-g[D],N=h?-T[I]/2:0,q=b===$?_[I]:T[I],P=b===$?-T[I]:-_[I],H=t.elements.arrow,Y=h&&H?v(H):{width:0,height:0},K=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},X=K[O],G=K[D],V=de(0,_[I],Y[I]),Z=w?_[I]/2-N-V-X-M:q-V-X-M,J=w?-_[I]/2+N+V+G+M:P+V+G+M,ee=t.elements.arrow&&E(t.elements.arrow),te=ee?"y"===k?ee.clientTop||0:ee.clientLeft||0:0,ne=t.modifiersData.offset?t.modifiersData.offset[t.placement][k]:0,ie=F[k]+Z-ne-te,oe=F[k]+J-ne,re=de(h?Math.min(U,ie):U,R,h?Math.max(j,oe):j);F[k]=re,z[k]=re-R}if(s){var ae="x"===k?L:C,se="x"===k?A:S,ce=F[x],ue=de(ce+g[ae],ce,ce-g[se]);F[x]=ue,z[x]=ue-ce}t.modifiersData[i]=z}},requiresIfExists:["offset"]};const he=P({defaultModifiers:[...G,ue,pe]});function fe(e){return/^[A-Za-z0-9 #&@()_+=':%/",.!?*~`[\]{}<>^;\\|-]+$/g.test(e.split(/[\r\n]+/).join())}function me(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}function ge(e,t,n){const i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),o=-1!==e.indexOf("?")?"&":"?";return e.match(i)?e.replace(i,"$1"+t+"="+n+"$2"):e+o+t+"="+n}const ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function ye(e){return String(e).replace(/[&<>"']/g,(function(e){return ve[e]}))}let be=0;function we(e){return new Promise((t=>setTimeout(t,e)))}async function ke(e,t="default",n=1800,i=!1){if(be>5)return;const o=document.querySelector(".toast-holder"),r=n+1e3*be,a=me(`\n        <div role="alert" aria-live="assertive" aria-atomic="true" class="toast fade showing">\n            <div class="toast-body ${t}">\n                <div class="toast-content">\n                    <span>${e}</span>\n                    ${i?`<button type="button" class="ml-2 close" data-dismiss="toast" aria-label="${gettext("Close")}"><span aria-hidden="true">&times;</span></button>`:""}\n                </div>\n            </div>\n        </div>`);o.prepend(a),i&&a.addEventListener("click",(async e=>{e.target.closest("[data-dismiss=toast]")&&(a.classList.remove("show"),await we(100),a.remove())})),await we(50),a.classList.add("show"),i||(be+=1,await we(r),a.classList.remove("show"),be-=1,await we(100),a.remove())}function xe(t,n=!1,i=gettext("something went wrong")){const o={method:"POST",headers:new Headers({"Content-Type":"application/json","X-CSRFToken":e(r).get("csrftoken")}),mode:"same-origin",body:JSON.stringify(t)},a=()=>(n||ke(i,"error"),{errors:[i]});return fetch("/graphql/",o).then((e=>e.ok?e.json():a())).catch((()=>a()))}const Ee=e(r).withConverter({read:e=>decodeURIComponent(e),write:e=>encodeURIComponent(e)}).withAttributes({sameSite:"Lax"});function Le(e,t,n){e.textContent=e.textContent===n?t:n}const Ae=document.querySelectorAll.bind(document),Se=document.querySelector.bind(document),Ce=e=>"string"==typeof e||e instanceof String;function Fe(e,t,n,...i){Ce(e)&&(e=Se(e)),e&&e.addEventListener(t,n,...i)}function _e(e,t,n,...i){Ce(e)&&(e=Ae(e)),e.forEach((e=>{e.addEventListener(t,n,...i)}))}const $e="au"===Se("body").id,Te=document.documentElement.lang;function Me(e,t){if(!t)return ye(e);const n="("+function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}(t)+")";return ye(e.replace(new RegExp(n,"gi"),"<mark>$1</mark>")).replace(/&lt;(\/?mark)&gt;/g,"<$1>")}class ze{suggest(e){if(this.cache){if(this.emptyResults.filter((t=>e.startsWith(Object.keys(t)[0]))).length)return void this.render([]);const[t]=this.cachedResults.filter((t=>t[e]));if(t)return void this.render(t[e])}this.lookup(e).then((t=>{const n=t.map((t=>({name:this.highlight?Me(t.name,e):ye(t.name),value:ye(t.value)})));if(this.cache&&"@"!==e){(n.length?this.cachedResults:this.emptyResults).push({[e]:n})}this.render(n)}))}render(e){if(this.popper||(this.popper=this.create()),e.length){this.template.innerHTML="";for(const[t,n]of e.entries())this.template.innerHTML+=`<li role="option" data-value="${n.value}" id="cb-opt-${t}">${n.name}</li>`}else{if(this.silent)return void this.destroy();this.template.querySelector(".no-results")||(this.template.innerHTML=`<li role="alert" aria-live="assertive" class='no-results'>${this.noResultsMessage}</li>`)}this.showing=!0,this.template.style.display="block",this.input.setAttribute("aria-expanded","true")}destroy(){this.popper&&(this.input.setAttribute("aria-expanded","false"),this.template.style.display="none",this.template.innerHTML="",this.selected=null,this.showing=!1,this.popper.destroy(),this.popper=null)}create(){return he(this.input,this.template,{placement:"bottom-start"})}triggerOnSelect(e){if(e.classList.contains("no-results"))return;this.destroy(),this.input.value=e.textContent;const t=e.getAttribute("data-value");t&&this.onSelect&&this.onSelect(t)}constructor(e){this.input=e.input,this.lookup=e.lookup,this.onSelect=e.onSelect,this.silent=!0===e.silent,this.highlight=e.highlight,this.noResultsMessage=e.noResultsMessage||gettext("-- no corresponding results --"),this.cache=!0===e.cache,this.cachedResults=[],this.emptyResults=[],this.popper=null,this.selected=null,this.showing=!1;const t=`id_${this.input.id}`;this.template=me(`<ul role="listbox" class="autocomplete" id="${t}"></ul>`),this.input.parentNode.append(this.template),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("role","combobox"),this.input.setAttribute("aria-owns",t),this.input.setAttribute("aria-autocomplete","list"),this.input.setAttribute("aria-expanded","false"),this.input.addEventListener("input",(()=>{const e=this.input.value.toLocaleLowerCase(Te).trim();this.selected=null,e?this.suggest(e):this.showing&&this.destroy()})),this.input.addEventListener("focusout",(()=>{setTimeout((()=>{this.destroy()}),200)})),this.input.addEventListener("keydown",(e=>{if(!["ArrowUp","ArrowDown","Escape","Enter","Tab"].includes(e.key))return;const t=["ArrowUp","ArrowDown"].includes(e.key);switch(t&&this.selected&&this.selected.classList.remove("selected","mouseover"),e.key){case"ArrowUp":{const t=this.template.lastChild;this.selected=this.selected&&this.selected.previousElementSibling||t,this.selected.classList.contains("no-results")||e.preventDefault();break}case"ArrowDown":{const e=this.template.firstChild;this.selected=this.selected&&this.selected.nextElementSibling||e;break}case"Escape":this.destroy();break;case"Enter":this.selected&&!this.selected.classList.contains("mouseover")&&(e.preventDefault(),this.triggerOnSelect(this.selected));break;case"Tab":this.selected&&!e.shiftKey&&(this.input.value=this.selected.textContent)}t&&this.selected&&!this.selected.classList.contains("no-results")&&(this.selected.classList.add("selected"),this.input.value=this.selected.textContent,this.input.setAttribute("aria-activedescendant",this.selected.id))})),this.template.addEventListener("click",(e=>{e.stopPropagation(),this.triggerOnSelect(e.target.closest("li"))})),this.template.addEventListener("mouseover",(e=>{"LI"!==e.target.tagName||e.target.classList.contains("no-results")||(Array.from(this.template.childNodes).forEach((t=>t!==e.target&&t.classList.remove("selected","mouseover"))),this.selected=e.target,this.selected.classList.add("selected","mouseover"))}))}}const Oe="query($lookup:String!){autocomplete{authors(lookup:$lookup){username}}}";function De(e){return xe({query:Oe,variables:{lookup:e.substr(1)}}).then((e=>e.data.autocomplete.authors.map((e=>({name:`@${e.username}`,value:`@${e.username}`})))))}function Ie(e){return e.startsWith("@")&&e.substr(1)?De(e):xe({query:"query($lookup:String!){autocomplete{authors(lookup:$lookup,limit:3){username}topics(lookup:$lookup,limit:7){title}}}",variables:{lookup:e}}).then((e=>{const t=e.data.autocomplete.topics.map((e=>({name:e.title,value:e.title}))),n=e.data.autocomplete.authors.map((e=>({name:`@${e.username}`,value:`@${e.username}`})));return t.concat(n)}))}new ze({input:Se("#header_search"),highlight:!0,cache:!0,lookup:Ie,onSelect(e){window.location="/topic/?q="+encodeURIComponent(e)}});const Re=Se("#editor_input");Re&&new ze({input:Re,silent:!0,highlight:!0,cache:!0,lookup:Ie});const Ue=Se("#in_topic_search");Ue&&new ze({input:Ue,silent:!0,highlight:!0,cache:!0,lookup:e=>e.startsWith("@")&&e.substr(1)?De(e):new Promise((e=>e)),onSelect(){Ue.closest("form").submit()}}),Ae(".author-search").forEach((e=>{new ze({input:e,highlight:!0,cache:!0,lookup:e=>xe({query:Oe,variables:{lookup:e}}).then((e=>e.data.autocomplete.authors.map((e=>({name:e.username,value:e.username})))))})}));const je=Se("#user_title_edit");je&&new ze({input:je,highlight:!0,cache:!0,lookup:e=>xe({query:"query($lookup:String!){autocomplete{topics(lookup:$lookup,limit:7){title}}}",variables:{lookup:e}}).then((e=>e.data.autocomplete.topics.map((e=>({name:e.title,value:e.title})))))});const Ne='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';function qe(e){return e.nextElementSibling?e.nextElementSibling.matches(Ne)?e.nextElementSibling:qe(e.nextElementSibling):null}function Pe(e){return e.previousElementSibling?e.previousElementSibling.matches(Ne)?e.previousElementSibling:Pe(e.previousElementSibling):null}let He,Be=null;class We{create(){const e=this.menuElement.getAttribute("data-orientation")||"bottom-end";return Be&&Be.destroy(),Be=this,he(this.button,this.menuElement,{placement:e,modifiers:[{name:"offset",options:{offset:[0,1]}}]})}async toggle(){await we(0),"block"!==this.menuElement.style.display?(this.popper||(this.popper=this.create()),this.menuElement.style.display="block",this.button.setAttribute("aria-expanded","true")):this.destroy()}destroy(){this.menuElement.style.display="none",this.button.setAttribute("aria-expanded","false"),this.popper&&(this.popper.destroy(),this.popper=null,Be=null)}constructor(e){this.button=e,this.menuElement=e.parentNode.querySelector(".dropdown-menu"),this.popper=null,this.menuElement.addEventListener("keydown",(e=>{if(["ArrowUp","ArrowDown"].includes(e.key)&&!this.menuElement.classList.contains("no-arrows"))switch(e.preventDefault(),e.key){case"ArrowDown":{const t=qe(e.target);t?t.focus():this.menuElement.querySelector(Ne).focus();break}case"ArrowUp":{const t=Pe(e.target);if(t)t.focus();else{const e=this.menuElement.querySelectorAll(Ne);e[e.length-1].focus()}break}}}))}}_e("[data-toggle=dropdown]","click",(function(){this._dropdownInstance||(this._dropdownInstance=new We(this)),this._dropdownInstance.toggle()})),_e("[data-toggle=dropdown]","keydown",(function(e){if("ArrowDown"===e.key){if(e.preventDefault(),this._dropdownInstance&&this._dropdownInstance.popper){const e=this._dropdownInstance.menuElement.querySelector(Ne);return void(e&&e.focus())}this.dispatchEvent(new Event("click"))}})),Fe(document,"mousedown",(e=>{He=e.target})),Fe(document,"mouseup",(()=>{He=null})),_e("[data-toggle=dropdown]","blur",(function(e){const t=this._dropdownInstance;if(!t)return;const n=He&&He.closest(".dropdown-menu")===t.menuElement;e.relatedTarget&&e.relatedTarget.closest(".dropdown-menu")===t.menuElement||n||t.destroy()})),Fe(document,"focusin",(e=>{e.target.matches("[data-toggle=dropdown]")||Be&&!e.target.closest(".dropdown-menu")&&Be.destroy()})),Fe(document,"keydown",(e=>{if("Escape"===e.key)if(Be)Be.destroy();else{const e=Se(".modal.show");e&&e._modalInstance.hide()}})),Fe(document,"click",(e=>{const t=Be;if(t){const n=t.menuElement.classList.contains("no-collapse")&&t.menuElement===e.target.closest(".dropdown-menu");(e.target.classList.contains("dropdown-close")||t.button!==e.target.closest("[data-toggle=dropdown]")&&!n)&&t.destroy()}}));class Qe{show(e){this.returnTo=e,this.showing=!0,this.modal.removeAttribute("aria-hidden"),this.modal.classList.add("showing"),this.modal.style.display="block",setTimeout((()=>{this.modal.classList.add("show"),this.lead.focus()}),0)}hide(){if(!this.showing)return!1;const e=this.modal;e.classList.remove("show"),new Promise((t=>{e.addEventListener("transitionend",(function n(i){i.target===e&&t(n)}))})).then((t=>{e.removeEventListener("transitionend",t),e.style.display="none",e.classList.remove("showing"),e.setAttribute("aria-hidden","true"),this.returnTo&&this.returnTo.focus()}))}constructor(e){this.modal=e,this.showing=!1,this.lead=e.querySelector(".lead"),e.addEventListener("click",(e=>{e.target.closest(".modal-content")&&!e.target.closest("[data-dismiss=modal]")||this.hide()}));const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=t[0],i=t[t.length-1];e.addEventListener("keydown",(e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===n&&(i.focus(),e.preventDefault()):document.activeElement===i&&(n.focus(),e.preventDefault()))}))}}Ae(".modal[role=dialog]").forEach((e=>{e._modalInstance=new Qe(e)}));const Ye=matchMedia("(hover: none)").matches;let Ke=!1,Xe=0,Ge=!1;const Ve=me(`<a role="button" tabindex="0" class="bg-light rounded border-0 w-100 p-2 d-none scrolltop text-center" style="display: block">${gettext("scroll to top")}</a>`);function Ze(){let e=window.pageYOffset;const t=Se("header.page_header"),n=Se(".sub-nav");if(e<0&&(e=0),e>0&&Ve.classList.remove("d-none"),Math.abs(Xe-e)<=30)return;const i=()=>{n.style.marginTop="0",t.style.top="0"};e>Xe?(n.style.marginTop=".75em",t.style.top="-55px",t.addEventListener("mouseover",i,{once:!0})):i(),Xe=e}Fe(Ve,"click",(function(){window.scrollTo(0,0),this.classList.add("d-none")}));const Je=window.matchMedia("(max-width: 810px)"),et=e=>{Ae("a[data-sup]").forEach((t=>{t.innerHTML=e?`<sup>${ye(t.getAttribute("data-sup"))}</sup>`:"*"}))};function tt(e){e.matches?function(){if(Ke=!0,window.addEventListener("scroll",Ze),et(!0),!Ge){const e=Se("footer.body-footer");e.parentNode.insertBefore(Ve,e),Ge=!0}}():(Ke=!1,parseInt(localStorage.getItem("where"),10)>0&&Se("#left-frame-nav").scroll(0,localStorage.getItem("where")),window.removeEventListener("scroll",Ze),Se(".sub-nav").style.marginTop="0",Se("header.page_header").style.top="0",et(!!Ye),Ge&&(Ve.remove(),Ge=!1))}Je.addListener(tt),document.addEventListener("DOMContentLoaded",(()=>{tt(Je);const e=Se("#request-messages");if("true"===e.getAttribute("data-has-messages")){let t=2e3;e.childNodes.forEach((e=>{const n=e.getAttribute("data-extra").includes("persistent");ke(e.getAttribute("data-message"),e.getAttribute("data-level"),t,n),t+=1e3}))}}));function nt(e){const t=Se("body"),n=Se("[data-toggle=theme]").querySelector("use");t.style.transition="background-color .5s ease","dark"===e?(t.classList.add("dark"),n.setAttribute("href","#sun")):(t.classList.remove("dark"),n.setAttribute("href","#moon"))}Fe("[data-toggle=theme]","click",(function(){$e?xe({query:"mutation{user{toggleTheme{theme}}}"}).then((e=>{nt(e.data.user.toggleTheme.theme)})):"dark"===Ee.get("theme")?(Ee.set("theme","light",{expires:90}),nt("light")):(Ee.set("theme","dark",{expires:90}),nt("dark"))})),$e||Ee.get("theme")||!window.matchMedia("(prefers-color-scheme: dark)").matches||(Ee.set("theme","dark",{expires:90}),nt("dark")),Fe("body","change",(e=>{e.target.matches("select.page-selector")&&(window.location=ge(location.href,"page",e.target.value))})),Fe("body",Ye?"touchstart":"focusin",(e=>{const t=e.target;if(t.matches("select.page-selector")&&!t.hasAttribute("data-loaded")){const e=parseInt(t.getAttribute("data-max"),10),n=parseInt(t.value,10);t.firstElementChild.remove();for(let i=1;i<=e;i++){const e=me(`<option ${i===n?"selected":""}>${i}</option>`);t.append(e)}t.setAttribute("data-loaded","")}})),Fe("form.search_mobile, form.reporting-form","submit",(function(){return Array.from(this.querySelectorAll("input")).filter((e=>"checkbox"===e.type&&!e.checked||""===e.value)).forEach((e=>{e.disabled=!0})),!1})),_e("[data-toggle=collapse]","click",(function(){this.closest("div").parentNode.querySelector(".collapse").classList.toggle("show"),"false"===this.getAttribute("aria-expanded")?this.setAttribute("aria-expanded","true"):this.setAttribute("aria-expanded","false")})),Fe("body","keypress",(e=>{!e.target.matches("[role=button], .key-clickable")||" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.target.dispatchEvent(new Event("click",{bubbles:!0})))})),Fe(".content-skipper","click",(function(){location.replace(this.getAttribute("data-href"))})),_e("input.is-invalid","input",(function(){this.classList.remove("is-invalid")})),_e("textarea.expandable","focus",(function(){this.style.height=`${this.offsetHeight+150}px`,Fe(this,"transitionend",(()=>{this.style.transition="none"}))}),{once:!0});const it={"":'"',"":'"',"":"'","":"'","":"^"};function ot(e){return String(e).replace(/[\u201C\u201D\u2018\u2019\u02C6]/g,(function(e){return it[e]}))}function rt(e){const t=[];return e.forEach((e=>{t.push(e.getAttribute("data-id"))})),t}function at(e){let t=e.closest("li.chat");return t||(t=e.parentNode),t}function st(e,t){return xe({query:"mutation($pkSet:[ID!]!, $mode:String){message{deleteConversation(pkSet:$pkSet,mode:$mode){redirect}}}",variables:{pkSet:e,mode:t}})}function lt(e){return xe({query:"mutation($pkSet:[ID!]!){message{archiveConversation(pkSet:$pkSet){redirect}}}",variables:{pkSet:e}})}_e("textarea#user_content_edit, textarea#message-body","input",(function(){window.onbeforeunload=()=>this.value||null,this.value=ot(this.value)})),_e("textarea.normalize","input",(function(){this.value=ot(this.value)})),_e("form","submit",(function(e){window.onbeforeunload=null,"header_search_form"!==this.id||new FormData(this).get("q").trim()||(e.preventDefault(),window.location="/threads/search/");const t=this.querySelector("#user_content_edit");if(t&&t.value&&!fe(t.value))return ke(gettext("this content includes forbidden characters."),"error"),window.onbeforeunload=()=>!0,e.preventDefault(),!1})),_e("button.follow-category-trigger","click",(function(){var e,t;(e="follow",t=this.getAttribute("data-category-id"),xe({query:`mutation{category{${e}(pk:"${t}"){feedback}}}`})).then((()=>{Le(this,pgettext("category-list","unfollow"),pgettext("category-list","follow")),this.classList.toggle("faded")}))})),Fe("a#message_history_show","click",(function(){Ae("ul#message_list li.bubble").forEach((e=>{e.style.display="list-item"})),this.classList.add("dj-hidden")})),Fe("a[role=button].chat-reverse","click",(()=>{Ae("input.chat-selector").forEach((e=>{e.checked=!e.checked,e.dispatchEvent(new Event("change"))}))})),_e("input.chat-selector","change",(function(){this.closest("li.chat").classList.toggle("selected")})),_e("a[role=button].chat-delete-individual","click",(function(){if(!confirm(gettext("are you sure to delete?")))return!1;const e=at(this),t=(Se("ul.threads")||e).getAttribute("data-mode");st(e.getAttribute("data-id"),t).then((t=>{const n=t.data.message.deleteConversation;n&&(Ae("li.chat").length>1?(e.remove(),ke(gettext("deleted conversation"))):window.location=n.redirect)}))})),Fe("a[role=button].chat-delete","click",(()=>{const e=Ae("li.chat.selected");if(e.length){if(!confirm(gettext("are you sure to delete all selected conversations?")))return!1;st(rt(e),Se("ul.threads").getAttribute("data-mode")).then((e=>{const t=e.data.message.deleteConversation;t&&(window.location=t.redirect)}))}else ke(gettext("you need to select at least one conversation to delete"),"error")})),Fe("a[role=button].chat-archive","click",(()=>{const e=Ae("li.chat.selected");if(e.length){if(!confirm(gettext("are you sure to archive all selected conversations?")))return!1;lt(rt(e)).then((e=>{const t=e.data.message.archiveConversation;t&&(window.location=t.redirect)}))}else ke(gettext("you need to select at least one conversation to archive"),"error")})),_e("a[role=button].chat-archive-individual","click",(function(){if(!confirm(gettext("are you sure to archive?")))return!1;const e=at(this);lt(e.getAttribute("data-id")).then((t=>{const n=t.data.message.archiveConversation;n&&(Ae("li.chat").length>1?(e.remove(),ke(gettext("archived conversation"))):window.location=n.redirect)}))})),Ae("#message_list time[data-id]").forEach((e=>{e.parentNode.append(me(`<div data-orientation="bottom" class="dropdown-menu"><a role="button" tabindex="0" class="dropdown-item">${gettext("delete")}</a></div>`))})),_e("#message_list .dropdown-menu","click",(function(e){if(e.target.classList.contains("dropdown-item")&&confirm(gettext("Are you sure?"))){xe({variables:{pk:this.parentNode.querySelector("time[data-id]").getAttribute("data-id")},query:"mutation($pk:ID!){message{delete(pk:$pk){immediate}}}"}).then((e=>{e.errors||(this.closest("li.bubble").remove(),document.querySelector("li.bubble")?"true"===e.data.message.delete.immediate&&ke(gettext("hopefully they didn't see that one."),"info"):window.location=location)}))}}));const ct=()=>{ke(gettext("image could not be displayed. it might have been deleted."),"error",2200)};function ut(e){return xe({query:"mutation($slug:String!){image{delete(slug:$slug){feedback}}}",variables:{slug:e}})}Fe(document,"click",(e=>{const t=e.target;if(t.matches(".entry a[data-img], .text-formatted a[data-img]")){if(t.hasAttribute("data-broken"))return void ct();if(t.hasAttribute("data-loaded"))t.nextElementSibling.classList.toggle("d-none"),t.nextElementSibling.nextElementSibling.classList.toggle("d-none"),"true"===t.getAttribute("aria-expanded")?t.setAttribute("aria-expanded","false"):t.setAttribute("aria-expanded","true");else{const e=t.parentNode;e.style.maxHeight="none";const n=e.querySelector(".read_more");n&&(n.style.display="none");const i=t.getAttribute("data-img"),o=me(`<img src="${i}" alt="${gettext("image")}" class="img-thumbnail img-fluid" draggable="false">`),r=me(`<a rel="ugc nofollow noopener" title="${gettext("open full image in new tab")}" href="${i}" target="_blank" class="ml-3 position-relative" style="top: 2px;"></a>`);o.onerror=()=>{ct(),o.style.display="none",r.style.display="none",t.setAttribute("data-broken","true")},t.after(r),r.after(o),t.setAttribute("aria-expanded","true")}t.setAttribute("data-loaded","true")}})),_e("a[role=button].delete-image","click",(function(){if(confirm(gettext("Are you sure?"))){const e=this.closest(".image-detail");ut(e.getAttribute("data-slug")),e.remove()}}));var dt=o("iS9jW");function pt(e,t){const n=e.selectionStart;if(n){const i=e.selectionEnd,o=e.scrollTop;e.value=e.value.substring(0,n)+t+e.value.substring(i,e.value.length),e.focus(),e.selectionStart=n+t.length,e.selectionEnd=n+t.length,e.scrollTop=o}else e.value+=t,e.focus()}function ht(e){let t;switch(e){case"ref":t=[gettext("target topic, #entry or @author to reference:"),e=>`(${pgettext("editor","see")}: ${e})`];break;case"thingy":t=[gettext("target topic, #entry or @author to thingy:"),e=>`\`${e}\``];break;case"swh":t=[gettext("what should be referenced in asterisk?"),e=>`\`:${e}\``];break;case"spoiler":{const e=gettext("spoiler");t=[gettext("what to write between spoiler tags?"),t=>`--\`${e}\`--\n${t}\n--\`${e}\`--`];break}}return{label:t[0],format:t[1]}}function ft(e,t){const n=e.selectionStart,i=e.selectionEnd,o=e.value,r=o.substring(n,i);if(r){if("link"===t){const t=prompt(gettext("which address to link?"),"http://");t&&"http://"!==t&&(e.value=o.substring(0,n)+`[${t} ${r}]`+o.substring(i,o.length))}else e.value=o.substring(0,n)+ht(t).format(r)+o.substring(i,o.length);return e.focus(),!0}return!1}let mt,gt;const vt=Se("#editor_done"),yt=Se("#editor_input"),bt=Se("#editorModal");bt&&(gt=bt.querySelector("label"));const wt=Se("#user_content_edit"),kt=Se(".dropzone");function xt(e,t,n=null,i=!0){return xe({query:`mutation{user{${e}(username:"${t}"){feedback redirect}}}`}).then((function(t){const o=t.data.user[e];i&&(n||o.redirect)?window.location=n||o.redirect:ke(o.feedback)}))}function Et(e,t=!0,n=null){const i=Se("#block_user");i.setAttribute("data-username",e),i.setAttribute("data-re",t),Se("#username-holder").textContent=e;Se("#blockUserModal")._modalInstance.show(n)}function Lt(e,t,n=null){const i=Se("#sendMessageModal");Se("#sendMessageModal span.username").textContent=e,t&&(Se("#sendMessageModal textarea#message_body").value=t),i.setAttribute("data-for",e),i._modalInstance.show(n)}function At(e,t,n=!1){return xe({query:`mutation{entry{${e}(pk:"${t}"){feedback ${n?"redirect":""}}}}`})}Fe("button#insert_image","click",(()=>{kt.style.display="none"===kt.style.display?"":"none"})),Fe("button#insert_link","click",(()=>{if(!ft(wt,"link")){const e=prompt(gettext("which address to link?"),"http://");if(e&&"http://"!==e){const t=prompt(gettext("alias for the link?"));pt(wt,t?`[${e} ${t}]`:e)}}})),Fe(vt,"click",(()=>{yt.value.trim()&&pt(wt,mt.format(yt.value.trim()))})),Fe(yt,"keydown",(e=>{"Enter"===e.key&&vt.dispatchEvent(new Event("click",{bubbles:!0}))})),_e("button.insert","click",(function(){const e=this.getAttribute("data-type");ft(wt,e)||(mt=ht(e),gt.textContent=mt.label,yt.value="",bt._modalInstance.show(null))})),e(dt).options.userImageUpload={addRemoveLinks:!0,paramName:"file",maxFilesize:2.5,acceptedFiles:"image/*",maxFiles:10,dictRemoveFileConfirmation:gettext("Are you sure?"),dictDefaultMessage:gettext("click or drop files here to upload"),dictRemoveFile:gettext("delete image"),dictFileTooBig:gettext("File is too big ({{filesize}}MB). Max filesize: {{maxFilesize}}MB."),dictMaxFilesExceeded:gettext("You can not upload any more files."),dictUploadCanceled:gettext("Upload canceled."),dictCancelUploadConfirmation:gettext("Are you sure?"),success(e,t){pt(wt,`(${pgettext("editor","image")}: ${t.slug})`)},removedfile(e){e.previewElement.remove();const t=JSON.parse(e.xhr.response).slug;wt.value=wt.value.replace(new RegExp(`\\(${pgettext("editor","image")}: ${t}\\)`,"g"),""),ut(t)}},_e(".block-user-trigger","click",(function(){const e=this.classList.contains("sync"),t=this.getAttribute("data-username");if(e)return xt("block",t,location);xt("block",t,null,!1).then(function(){Le(this,gettext("remove block"),gettext("block this guy"))}.bind(this))})),_e(".follow-user-trigger","click",(function(){xt("follow",this.parentNode.getAttribute("data-username")),Le(this.querySelector("a"),gettext("follow"),gettext("unfollow"))})),Fe("ul.user-links","click",(function(e){const t=this.getAttribute("data-username");e.target.matches("li.block-user a")?Et(t,!0,e.target):e.target.matches("li.send-message a")&&Lt(t,null,e.target)})),Fe("#block_user","click",(function(){const e=this.getAttribute("data-username"),t="true"===this.getAttribute("data-re");t||Ae(".entry-full").forEach((t=>{t.querySelector(".meta .username").textContent===e&&t.remove()})),xt("block",e,null,t)})),Fe("#send_message_btn","click",(function(){const e=Se("#sendMessageModal textarea"),t=Se("#sendMessageModal"),n=e.value;n.length<3?ke(gettext("if only you could write down something"),"error"):fe(n)?(this.disabled=!0,function(e,t){return xe({query:"mutation compose($body:String!,$recipient:String!){message{compose(body:$body,recipient:$recipient){feedback}}}",variables:{recipient:e,body:t}}).then((function(e){ke(e.data.message.compose.feedback)}))}(t.getAttribute("data-for"),n).then((()=>{t._modalInstance.hide(),e.value=""})).finally((()=>{this.disabled=!1}))):ke(gettext("this content includes forbidden characters."),"error")})),_e("a.favorite[role='button']","click",(function(){xe({query:`mutation{entry{favorite(pk:"${this.closest(".entry-full").getAttribute("data-id")}"){feedback count}}}`}).then((e=>{const t=e.data.entry.favorite.count,n=this.nextElementSibling;this.classList.toggle("active"),0===t?(n.textContent="",n.setAttribute("tabindex","-1")):(n.textContent=t,n.setAttribute("tabindex","0")),this.parentNode.querySelector("span.favorites-list").setAttribute("data-loaded","false")}))})),_e("a.fav-count[role='button']","click",(function(){const e=this.nextElementSibling;if("true"===e.getAttribute("data-loaded"))return;e.innerHTML="<div class='px-3 py-1'><div class='spinning'><span style='font-size: 1.25em'>&orarr;</span></div></div>";xe({query:`{entry{favoriters(pk:${this.closest(".entry-full").getAttribute("data-id")}){username slug isNovice}}}`}).then((t=>{const n=t.data.entry.favoriters,i=n.filter((e=>!1===e.isNovice)),o=n.filter((e=>!0===e.isNovice));if(e.innerHTML="",e.setAttribute("data-loaded","true"),!n.length)return void(e.innerHTML=`<span class='p-2'>${gettext("actually, nothing here.")}</span>`);let r="";if(i.length>0&&(i.forEach((e=>{r+=`<a class="author" href="/author/${e.slug}/">@${e.username}</a>`})),e.innerHTML=r),o.length>0){const t=me(`<a role="button" tabindex="0">${interpolate(ngettext("... %(count)s novice","... %(count)s novices",o.length),{count:o.length},!0)}</a>`),n=me('<span class="dj-hidden"></span>');e.append(t),t.addEventListener("click",(()=>{n.classList.toggle("dj-hidden")})),r="",o.forEach((e=>{r+=`<a class="novice" href="/author/${e.slug}/">@${e.username}</a>`})),n.innerHTML=r,e.append(n)}}))})),_e("a.twitter[role='button'], a.facebook[role='button']","click",(function(){const e=this.classList.contains("twitter")?"https://twitter.com/intent/tweet?text=":"https://www.facebook.com/sharer/sharer.php?u=",t=this.closest(".entry-footer").querySelector(".meta .permalink").getAttribute("href"),n=window.open();n.opener=null,n.location=`${e}${window.location.origin}${t}`})),_e(".entry-vote .vote","click",(function(){const e=this.classList.contains("upvote")?"upvote":"downvote",t=this.closest(".entry-full").getAttribute("data-id");At(e,t).then((t=>{const n=t.data.entry[e].feedback;if(null==n){(this.nextElementSibling||this.previousElementSibling).classList.remove("active"),this.classList.toggle("active")}else ke(n,"error",4e3)}))})),_e(".comment-vote .vote","click",(function(){const e=this.classList.contains("upvote")?"upvote":"downvote";xe({query:"mutation($pk:ID!,$action:String!){entry{votecomment(pk:$pk,action:$action){count}}}",variables:{pk:this.parentNode.getAttribute("data-id"),action:e}}).then((e=>{e.errors?e.errors.forEach((e=>{ke(e.message,"error")})):(this.parentNode.querySelectorAll(".vote").forEach((e=>{e!==this&&e.classList.remove("active")})),this.classList.toggle("active"),this.parentNode.querySelector(".rating").textContent=e.data.entry.votecomment.count)}))})),_e(".entry-actions","click",(function(e){const t=e.target.closest(".dropdown-item"),[n]=["message","pin","block","delete","copy","share"].filter((e=>t.classList.contains(e)));switch(n){case"message":Lt(this.parentNode.querySelector(".username").textContent,`\`#${this.closest(".entry-full").getAttribute("data-id")}\`:\n`,this.previousElementSibling);break;case"pin":{const e=this.closest(".entry-full").getAttribute("data-id"),t=Se("body");At("pin",e).then((n=>{Ae("a.action[role='button']").forEach((e=>{e.classList.remove("loaded")})),t.getAttribute("data-pin")===e?t.removeAttribute("data-pin"):t.setAttribute("data-pin",e),ke(n.data.entry.pin.feedback)}));break}case"block":{const e=this.parentNode.querySelector(".username").textContent,t=Se(".profile-username");Et(e,t&&t.textContent===e,this.previousElementSibling);break}case"delete":if(confirm(gettext("are you sure to delete?"))){const e=this.closest(".entry-full"),t=1===Ae("ul.topic-view-entries li.entry-full").length;At("delete",e.getAttribute("data-id"),t).then((n=>{const i=n.data.entry.delete;t?window.location=i.redirect:(e.remove(),ke(i.feedback))}))}break;case"copy":{const e=this.parentNode.querySelector(".permalink").href;navigator.clipboard.writeText(e).then((()=>{ke(gettext("link copied to clipboard."),"info")}));break}case"share":{const e=this.parentNode.querySelector(".permalink").href;navigator.share({url:e});break}}}));const St=(e,t=16,n=16)=>`<svg fill="currentColor" viewBox="0 0 ${t} ${n}"><use href="#${e}"></use></svg>`;function Ct(e,t=null,n=null){return xe({query:"mutation($content:String!,$pk:ID,$title:String){entry{edit(content:$content,pk:$pk,title:$title){pk,content,feedback}}}",variables:{content:e,title:n,pk:t}}).then((e=>{if(!e.errors){const t=Se("button.draft-async");return t.textContent=gettext("save changes"),t.hasAttribute("data-pk")||t.after(me(`<button type="button" class="btn btn-django-link fs-90 ml-3 draft-del">${gettext("delete")}</button>`)),window.onbeforeunload=null,ke(e.data.entry.edit.feedback,"info"),e}e.errors.forEach((e=>{ke(e.message,"error")}))}))}_e(".entry-full a.action[role='button']","click",(function(){if(this.classList.contains("loaded"))return;const e=this.closest(".entry-full"),t=e.getAttribute("data-id"),n=encodeURIComponent(e.closest("[data-topic]").getAttribute("data-topic")),i=this.parentNode.querySelector(".entry-actions"),o=t===Se("body").getAttribute("data-pin")?gettext("unpin from profile"):gettext("pin to profile");i.innerHTML="";let r="";$e&&(e.classList.contains("commentable")&&(r+=`<a target="_blank" href="/entry/${t}/comment/" class="dropdown-item">${St("comment")}${gettext("comment")}</a>`),e.classList.contains("owner")?(r+=`<a role="button" tabindex="0" class="dropdown-item pin">${St("pin")}${o}</a>`,r+=`<a role="button" tabindex="0" class="dropdown-item delete">${St("trash")}${gettext("delete")}</a>`,r+=`<a href="/entry/update/${t}/" class="dropdown-item">${St("edit",44,44)}${gettext("edit")}</a>`):e.classList.contains("private")||(r+=`<a role="button" tabindex="0" class="dropdown-item message">${St("message")}${gettext("message")}</a>`,r+=`<a role="button" tabindex="0" class="dropdown-item block">${St("block")}${gettext("block")}</a>`)),Ye&&!navigator.share&&(r+=`<a role="button" tabindex="0" class="dropdown-item copy">${St("link")}${gettext("copy link")}</a>`),navigator.share&&(r+=`<a role="button" tabindex="0" class="dropdown-item share">${St("share")}${gettext("share")}</a>`),r+=`<a class="dropdown-item" href="/contact/?referrer_entry=${t}&referrer_topic=${n}">${St("flag")}${gettext("report")}</a>`,i.innerHTML=r,this.classList.add("loaded")})),Fe(".delete-entry-redirect","click",(function(){confirm(gettext("are you sure to delete?"))&&At("delete",this.getAttribute("data-target-entry"),!0).then((e=>{window.location=e.data.entry.delete.redirect}))})),Fe(".pin-sync","click",(function(){At("pin",this.getAttribute("data-id")).then((e=>{ke(e.data.entry.pin.feedback),window.location=location}))})),window.onload=()=>{Se("body").classList.contains("has-entries")&&Ae("article.entry p").forEach((e=>{if((e=>e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)(e)){const t=me(`<div role="button" tabindex="0" class="read_more">${gettext("continue reading")}</div>`);e.parentNode.append(t),Fe(t,"click",(function(){e.style.maxHeight="none",this.style.display="none"}))}}))};const Ft=Se("#user_title_edit");function _t(e){const t=JSON.parse(Ee.get("lfex")||"null");return e?(t&&e.forEach((n=>{t.includes(n)?e=t.filter((e=>e!==n)):(t.push(n),e=t)})),Ee.set("lfex",JSON.stringify(e),{expires:90}),e):t}Fe("button.draft-async","click",(function(){const e=this.getAttribute("data-title")||Ft&&Ft.value,t=this.getAttribute("data-pk"),n=Se("#user_content_edit").value;n.trim()&&(null===e||e.trim())?t?Ct(n,t).then((e=>{e&&(Se("p.pw-text").innerHTML=e.data.entry.edit.content)})):e&&Ct(n,null,e).then((e=>{if(e){Se(".user-content").prepend(me(`<section class="pw-area"><h2 class="h5 text-muted">${gettext("preview")}</h2><p class="text-formatted pw-text">${e.data.entry.edit.content}</p></section>`));const t=e.data.entry.edit.pk;this.setAttribute("data-pk",t),Se("#content-form").prepend(me(`<input type="hidden" name="pub_draft_pk" value="${t}" />`)),Ft&&(Ft.disabled=!0,Ft.classList.add("highlighted"))}})):ke(gettext("if only you could write down something"),"error")})),Fe(document,"click",(e=>{if(e.target.matches("button.draft-del")&&confirm(gettext("Are you sure?"))){const t=Se("button.draft-async");At("delete",t.getAttribute("data-pk")).then((n=>{Se("section.pw-area").remove(),Se("#user_content_edit").value="",Se("[name=pub_draft_pk]").remove(),t.textContent=gettext("keep this as draft"),t.removeAttribute("data-pk"),e.target.remove(),Ft&&(Ft.disabled=!1,Ft.classList.remove("highlighted")),ke(n.data.entry.delete.feedback,"info")}))}})),Fe(".allowsave","keydown",(e=>{(e.ctrlKey||e.metaKey)&&"s"===String.fromCharCode(e.which).toLowerCase()&&(e.preventDefault(),Se("button.draft-async").dispatchEvent(new Event("click")))}));class $t{setCookies(){if(Ee.set("lfac",this.slug),Ee.set("lfnp",this.page),this.tab?Ee.set("lfat",this.tab):this.tab=Ee.get("lfat")||null,this.extra?Ee.set("lfea",this.extra):this.extra=Ee.get("lfea")||null,"today-in-history"===this.slug){const e=Ee.get("lfsy");this.year?Ee.set("lfsy",this.year):this.year=e||null}else if("search"===this.slug){const e=Ee.get("lfsp");this.searchKeys?Ee.set("lfsp",this.searchKeys):this.searchKeys=e||null}else"popular"===this.slug&&(this.exclusions=_t(this.exclusions))}call(){this.loadIndicator.style.display="inline";xe({query:"query($slug: String!,$year:Int,$page:Int,$searchKeys:String,$refresh:Boolean,$tab:String,\n            $exclusions:[String],$extra:JSONString){topics(slug:$slug,year:$year,page:$page,searchKeys:$searchKeys,\n            refresh:$refresh,tab:$tab,exclusions:$exclusions,extra:$extra){\n                safename refreshCount year yearRange slugIdentifier parameters\n                page { objectList { slug title count } paginator { pageRange numPages } number hasOtherPages hasNext }\n                tabs{current available{name, safename}}\n                exclusions{active, available{name, slug, description}}\n            }}",variables:{slug:this.slug,year:parseInt(this.year,10),page:parseInt(this.page,10),searchKeys:this.searchKeys,refresh:this.refresh,tab:this.tab,exclusions:this.exclusions,extra:this.extra}},!0).then((e=>{e.errors?(this.loadIndicator.style.display="none",ke(gettext("something went wrong"),"error")):this.render(e.data.topics)}))}render(e){Se("#left-frame-nav").scroll({top:0,behavior:"smooth"}),Se("#current_category_name").textContent=e.safename,this.renderRefreshButton(e.refreshCount),this.renderYearSelector(e.year,e.yearRange),this.renderPagination(e.page.hasOtherPages,e.page.paginator.pageRange,e.page.paginator.numPages,e.page.number,e.page.hasNext),this.renderTopicList(e.page.objectList,e.slugIdentifier,e.parameters),this.renderShowMoreButton(e.page.number,e.page.hasOtherPages),this.renderTabs(e.tabs),this.renderExclusions(e.exclusions),this.loadIndicator.style.display="none"}renderRefreshButton(e){const t=Se("#refresh_bugun");e?(t.classList.remove("dj-hidden"),Se("span#new_content_count").textContent=`(${e})`):t.classList.add("dj-hidden")}renderShowMoreButton(e,t){const n=Se("a#show_more");1===e&&t?n.classList.remove("d-none"):n.classList.add("d-none")}renderTabs(e){const t=Se("ul#left-frame-tabs");e?(t.innerHTML="",e.available.forEach((n=>{t.innerHTML+=`<li class="nav-item"><a role="button" tabindex="0" data-lf-slug="${this.slug}" data-tab="${n.name}" class="nav-link${e.current===n.name?" active":""}">${n.safename}</a></li>`})),t.classList.remove("dj-hidden")):t.classList.add("dj-hidden")}renderExclusions(e){const t=Se("#popular_excluder"),n=Se("#exclusion-choices"),i=n.querySelector("ul.exclusion-choices");e?(i.innerHTML="",t.classList.remove("dj-hidden"),e.available.forEach((t=>{const n=e.active.includes(t.slug);i.innerHTML+=`<li><a role="button" title="${t.description}" ${n?'class="active"':""} tabindex="0" data-slug="${t.slug}">#${t.name}</a></li>`})),e.active.length?t.classList.add("active"):t.classList.remove("active")):(t.classList.add("dj-hidden"),n.classList.add("dj-hidden"))}renderYearSelector(e,t){const n=Se("#year_select");n.innerHTML="","today-in-history"===this.slug?(n.style.display="block",t.forEach((t=>{n.innerHTML+=`<option ${t===e?"selected":""} id="${t}">${t}</option>`}))):n.style.display="none"}renderTopicList(e,t,n){const i=Se("ul#topic-list");if(0===e.length)i.innerHTML=`<small>${gettext("nothing here")}</small>`;else{i.innerHTML="";const o=n||"";let r="";e.forEach((e=>{r+=`<li class="list-group-item"><a href="${t}${e.slug}/${o}">${ye(e.title)}<small class="total_entries">${e.count&&"0"!==e.count?e.count:""}</small></a></li>`})),r&&(i.innerHTML=r)}}renderPagination(e,t,n,i,o){const r=Se("#lf_pagination_wrapper"),a=Se("select#left_frame_paginator"),s=Se("#lf_total_pages"),l=Se("#lf_navigate_after");if(e&&1!==i){a.innerHTML="";let e="";t.forEach((t=>{e+=`<option ${t===i?"selected":""} value="${t}">${t}</option>`})),a.innerHTML+=e,s.textContent=n,l.classList[o?"remove":"add"]("d-none"),r.classList.remove("dj-hidden")}else r.classList.add("dj-hidden")}static populate(e,t=1,...n){if(Ke)return;new $t(e,t,...n).call()}static refreshPopulate(){$t.populate("today",1,null,null,!0)}constructor(e,t=1,n=null,i=null,o=!1,r=null,a=null,s=null){this.slug=e,this.page=t,this.year=n,this.refresh=o,this.searchKeys=i,this.tab=r,this.exclusions=a,this.extra=s,this.setCookies(),this.loadIndicator=Se("#load_indicator")}}Fe("body","click",(e=>{const t=e.target.closest("[data-lf-slug]");if(t&&!Ke){const n=t.getAttribute("data-lf-slug"),i=t.getAttribute("data-tab")||null,o=t.getAttribute("data-lf-extra")||null;$t.populate(n,1,null,null,!1,i,null,o),t.classList.contains("dropdown-item")&&e.stopPropagation(),e.preventDefault()}})),Fe("#year_select","change",(function(){const e=this.value;$t.populate("today-in-history",1,e)})),Fe("select#left_frame_paginator","change",(function(){$t.populate(Ee.get("lfac"),this.value)}));const Tt=Se("select#left_frame_paginator"),Mt=Se("#lf_total_pages"),zt=new Event("change");function Ot(e){if(!e)return;const t="search";Ke&&(window.location=`/threads/${t}/?${e}`),$t.populate(t,1,null,e)}function Dt(e,t=null){return xe({query:"mutation wish($title:String!,$hint:String){topic{wish(title:$title,hint:$hint){feedback hint}}}",variables:{title:e,hint:t}})}Fe(Mt,"click",(function(){Tt.value!==this.textContent&&(Tt.value=this.textContent,Tt.dispatchEvent(zt))})),Fe("#lf_navigate_before","click",(()=>{const e=parseInt(Tt.value,10);e-1>0&&(Tt.value=e-1,Tt.dispatchEvent(zt))})),Fe("#lf_navigate_after","click",(()=>{const e=parseInt(Tt.value,10);e+1<=parseInt(Mt.textContent,10)&&(Tt.value=e+1,Tt.dispatchEvent(zt))})),Fe("a#show_more","click",(function(){const e=Ee.get("lfac");e&&($t.populate(e,2),Se("#left-frame-nav").scroll(0,0)),this.classList.add("d-none")})),Fe("#refresh_bugun","click",$t.refreshPopulate),_e(".exclusion-button","click",(function(){this.closest("div").parentNode.querySelector(".exclusion-settings").classList.toggle("dj-hidden")})),Fe("#exclusion-choices","click",(e=>{"A"===e.target.tagName&&(e.target.classList.toggle("active"),$t.populate("popular",1,null,null,null,null,[e.target.getAttribute("data-slug")]))})),Fe("#exclusion-settings-mobile","click",(e=>{"A"===e.target.tagName&&(_t([e.target.getAttribute("data-slug")]),window.location=location)})),_e("[data-lf-slug]","click",(function(){Ae("[data-lf-slug]").forEach((e=>e.classList.remove("active"))),Ae(`[data-lf-slug=${this.getAttribute("data-lf-slug")}]`).forEach((e=>e.classList.add("active")))})),Fe("select#mobile_year_changer","change",(function(){window.location=ge(location.href,"year",this.value)})),Fe("#left-frame-nav","scroll",(function(){localStorage.setItem("where",this.scrollTop)})),Fe("button#perform_advanced_search","click",(()=>{const e=Se("input#in_favorites_dropdown");Ot(function(e){const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&e[n]&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}({keywords:Se("input#keywords_dropdown").value,author_nick:Se("input#author_nick_dropdown").value,is_nice_ones:Se("input#nice_ones_dropdown").checked,is_in_favorites:e&&e.checked,from_date:Se("input#date_from_dropdown").value,to_date:Se("input#date_to_dropdown").value,ordering:Se("select#ordering_dropdown").value}))})),_e("body","click",(e=>{if(e.target.matches("a[role=button].quicksearch")){const t=e.target.getAttribute("data-keywords");let n;n=t.startsWith("@")&&t.substr(1)?`author_nick=${t.substr(1)}`:`keywords=${t}`;Ot(n+"&ordering=newer")}})),Fe(".follow-topic-trigger","click",(function(){var e,t;Le(this,gettext("unfollow"),gettext("follow")),e="follow",t=this.getAttribute("data-topic-id"),xe({query:`mutation{topic{${e}(pk:"${t}"){feedback}}}`}).then((t=>{ke(t.data.topic[e].feedback)}))})),_e(".suggestion-vote button","click",(function(){const e=this.classList.contains("up")?1:-1,t=this.parentNode.getAttribute("data-topic");xe({query:"mutation($category:String!,$topic:String!,$direction:Int!){category{suggest(category:$category,topic:$topic,direction:$direction){feedback}}}",variables:{category:this.parentNode.getAttribute("data-category"),topic:t,direction:e}}).then((e=>{if(e.errors)e.errors.forEach((e=>{ke(e.message,"error")}));else{this.classList.toggle("btn-django-link");(this.nextElementSibling||this.previousElementSibling).classList.remove("btn-django-link")}}))})),Fe("a.wish-prepare[role=button]","click",(function(){this.parentNode.querySelectorAll(":not(.wish-purge):not(.wish-prepare)").forEach((e=>{e.classList.toggle("dj-hidden")})),Le(this,gettext("someone should populate this"),gettext("nevermind"))})),Fe("a.wish-send[role=button]","click",(function(){const e=this.parentNode.querySelector("textarea"),t=e.value;if(t&&!fe(t))return void ke(gettext("this content includes forbidden characters."),"error");Dt(this.parentNode.getAttribute("data-topic"),t).then((t=>{if(t.errors)return void t.errors.forEach((e=>{ke(e.message,"error")}));e.value="",Array.from(this.parentNode.children).forEach((e=>{e.classList.toggle("dj-hidden")}));const n=t.data.topic.wish.hint,i=Se("ul#wish-list");i.classList.remove("dj-hidden"),i.prepend(me(`<li class="list-group-item owner">${gettext("you just wished for this topic.")} ${n?`${gettext("your hint:")} <p class="m-0 text-formatted"><i>${n}</i></p>`:""}</li>`)),window.scrollTo({top:0,behavior:"smooth"}),ke(t.data.topic.wish.feedback)}))})),Fe("a.wish-purge[role=button]","click",(function(){const e=this.parentNode.getAttribute("data-topic");confirm(gettext("are you sure to delete?"))&&Dt(e).then((e=>{this.classList.toggle("dj-hidden");const t=Se("ul#wish-list"),n=this.parentNode.querySelector(".wish-prepare");n.textContent=gettext("someone should populate this"),n.classList.toggle("dj-hidden"),t.querySelector("li.owner").remove(),t.children.length||t.classList.add("dj-hidden"),ke(e.data.topic.wish.feedback)}))})),Fe(".snap-user-content","click",(()=>{Se("#user_content_edit").focus()}));const It=Se(".topic-view-entries"),Rt=Se(".pagination");if(It&&Rt){const e=Rt.cloneNode(!0);e.style.justifyContent="flex-end",e.classList.add("mt-2"),It.after(e)}}();
